var ExtensionFramework=function(t){"use strict";const e={Boolean:"Boolean",Button:"button",Command:"command",Conditional:"conditional",Event:"event",Hat:"hat",Loop:"loop",Reporter:"reporter"},n={Angle:"angle",Boolean:"Boolean",Color:"color",Number:"number",String:"string",Matrix:"matrix",Note:"note",Image:"image",Custom:"custom"},r={BackgroundLayer:"background",VideoLayer:"video",PenLayer:"pen",SpriteLayer:"sprite"},i=[r.VideoLayer,r.SpriteLayer,r.BackgroundLayer,r.PenLayer],a={"Аҧсшәа":"ab","العربية":"ar","አማርኛ":"am",Azeri:"az",Bahasa_Indonesia:"id","Беларуская":"be","Български":"bg","Català":"ca","Česky":"cs",Cymraeg:"cy",Dansk:"da",Deutsch:"de",Eesti:"et","Ελληνικά":"el",English:"en","Español":"es","Español_Latinoamericano":"es-419",Euskara:"eu","فارسی":"fa","Français":"fr",Gaeilge:"ga","Gàidhlig":"gd",Galego:"gl","한국어":"ko","עִבְרִית":"he",Hrvatski:"hr",isiZulu:"zu","Íslenska":"is",Italiano:"it","ქართული_ენა":"ka",Kiswahili:"sw","Kreyòl_ayisyen":"ht","کوردیی_ناوەندی":"ckb","Latviešu":"lv","Lietuvių":"lt",Magyar:"hu","Māori":"mi",Nederlands:"nl","日本語":"ja","にほんご":"ja-Hira","Norsk_Bokmål":"nb",Norsk_Nynorsk:"nn","Oʻzbekcha":"uz","ไทย":"th","ភាសាខ្មែរ":"km",Polski:"pl","Português":"pt","Português_Brasileiro":"pt-br",Rapa_Nui:"rap","Română":"ro","Русский":"ru","Српски":"sr","Slovenčina":"sk","Slovenščina":"sl",Suomi:"fi",Svenska:"sv","Tiếng_Việt":"vi","Türkçe":"tr","Українська":"uk","简体中文":"zh-cn","繁體中文":"zh-tw"},o=Object.keys(a);class s{static get RGB_BLACK(){return{r:0,g:0,b:0}}static get RGB_WHITE(){return{r:255,g:255,b:255}}static decimalToHex(t){t<0&&(t+=16777216);let e=Number(t).toString(16);return e=`#${"000000".substr(0,6-e.length)}${e}`,e}static decimalToRgb(t){const e=t>>24&255;return{r:t>>16&255,g:t>>8&255,b:255&t,a:e>0?e:255}}static hexToRgb(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,n,r)=>e+e+n+n+r+r));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}static rgbToHex(t){return s.decimalToHex(s.rgbToDecimal(t))}static rgbToDecimal(t){return(t.r<<16)+(t.g<<8)+t.b}static hexToDecimal(t){return s.rgbToDecimal(s.hexToRgb(t))}static hsvToRgb(t){let e=t.h%360;e<0&&(e+=360);const n=Math.max(0,Math.min(t.s,1)),r=Math.max(0,Math.min(t.v,1)),i=Math.floor(e/60),a=e/60-i,o=r*(1-n),s=r*(1-n*a),c=r*(1-n*(1-a));let l,u,p;switch(i){default:case 0:l=r,u=c,p=o;break;case 1:l=s,u=r,p=o;break;case 2:l=o,u=r,p=c;break;case 3:l=o,u=s,p=r;break;case 4:l=c,u=o,p=r;break;case 5:l=r,u=o,p=s}return{r:Math.floor(255*l),g:Math.floor(255*u),b:Math.floor(255*p)}}static rgbToHsv(t){const e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(Math.min(e,n),r),a=Math.max(Math.max(e,n),r);let o=0,s=0;if(i!==a){o=60*((e===i?3:n===i?5:1)-(e===i?n-r:n===i?r-e:e-n)/(a-i))%360,s=(a-i)/a}return{h:o,s:s,v:a}}static mixRgb(t,e,n){if(n<=0)return t;if(n>=1)return e;const r=1-n;return{r:r*t.r+n*e.r,g:r*t.g+n*e.g,b:r*t.b+n*e.b}}}const c=s;class l{static toNumber(t){if("number"==typeof t)return Number.isNaN(t)?0:t;const e=Number(t);return Number.isNaN(e)?0:e}static toBoolean(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t.toLowerCase():Boolean(t)}static toString(t){return String(t)}static toRgbColorList(t){const e=l.toRgbColorObject(t);return[e.r,e.g,e.b]}static toRgbColorObject(t){let e;return"string"==typeof t&&"#"===t.substring(0,1)?(e=c.hexToRgb(t),e||(e={r:0,g:0,b:0,a:255})):e=c.decimalToRgb(l.toNumber(t)),e}static isWhiteSpace(t){return null===t||"string"==typeof t&&0===t.trim().length}static compare(t,e){let n=Number(t),r=Number(e);if(0===n&&l.isWhiteSpace(t)?n=NaN:0===r&&l.isWhiteSpace(e)&&(r=NaN),isNaN(n)||isNaN(r)){const n=String(t).toLowerCase(),r=String(e).toLowerCase();return n<r?-1:n>r?1:0}return n===1/0&&r===1/0||n===-1/0&&r===-1/0?0:n-r}static isInt(t){return"number"==typeof t?!!isNaN(t)||t===parseInt(t,10):"boolean"==typeof t||"string"==typeof t&&t.indexOf(".")<0}static get LIST_INVALID(){return"INVALID"}static get LIST_ALL(){return"ALL"}static toListIndex(t,e,n){if("number"!=typeof t){if("all"===t)return n?l.LIST_ALL:l.LIST_INVALID;if("last"===t)return e>0?e:l.LIST_INVALID;if("random"===t||"any"===t)return e>0?1+Math.floor(Math.random()*e):l.LIST_INVALID}return(t=Math.floor(l.toNumber(t)))<1||t>e?l.LIST_INVALID:t}}var u=l;const p="OPEN_UI_FROM_EXTENSION",m="REGISTER_BUTTON_CALLBACK_FROM_EXTENSION",d="internal_IsCustomArgument",g="isCustomArgumentHack",h="dropdownState",_="dropdownEntry",y="init",f="open",S="close",T=(t,e)=>t.emit(p,e),I=(t,e,n)=>{t.emit(m,e),t.on(e,n)};var E;!function(t){t.ui="ui";t.text="text";t.motion="motion";t.red="red";t.sound="sound";t.control="control";t.data="data";t.pen="pen";t.error="error";t.extensions="extensions";t.drop="drop"}(E||(E={}));class b{constructor(t){this.root=t}get(...t){return`var(--${this.root}-${t.join("-")})`}primary(...t){return this.get("primary",...t)}secondary(...t){return this.get("secondary",...t)}tertiary(...t){return this.get("tertiary",...t)}transparent(...t){return this.get("transparent",...t)}light(...t){return this.get("light",...t)}}const A=new b(E.ui),O=new b(E.text),v=new b(E.motion),C=new b(E.red),D=new b(E.sound),R=new b(E.control),N=new b(E.data),w=new b(E.pen),L=new b(E.error),x=new b(E.extensions),k=new b(E.extensions),P={ui:{primary:A.primary(),secondary:A.secondary(),tertiary:A.tertiary(),modalOverlay:A.get("modal","overlay"),white:A.get("white"),whiteDim:A.get("white","dim"),whiteTransparent:A.get("white","transparent"),transparent:A.transparent(),blackTransparent:A.get("black","transparent")},text:{primary:O.primary(),primaryTransparent:O.transparent()},motion:{primary:v.primary(),tertiary:v.tertiary(),transparent:v.get("transparent"),lightTansparent:v.light("transparent")},red:{primary:C.primary(),tertiary:C.tertiary()},sound:{primary:D.primary(),tertiary:D.tertiary()},control:{primary:R.primary()},data:{primary:N.primary()},pen:{primary:w.primary(),transparent:w.transparent()},error:{primary:L.primary(),light:L.light(),transparent:L.transparent()},extensions:{primary:x.primary(),tertiary:x.tertiary(),light:x.light(),transparent:x.transparent()},drop:{highlight:k.get("highlight")}};async function M(t,e=100){let n,r=t();for(;!r;)await new Promise((t=>{clearTimeout(n),n=setTimeout(t,e)})),r=t();return clearTimeout(n),r}const B=t=>"string"==typeof t||t instanceof String,G=t=>"[object Function]"===Object.prototype.toString.call(t)||"function"==typeof t||t instanceof Function,$=t=>t!==Object(t),F=t=>t,U=async t=>{const e=new Promise(((e,n)=>{const r=document.createElement("script");r.onload=e,r.onerror=n,r.async=!0,r.src=t,document.body.appendChild(r)}));await e},j=t=>{[["goog-menuitem goog-option",t=>{t.margin="auto",t.paddingLeft=t.paddingRight="0px"}],["goog-menuitem-content",t=>t.textAlign="center"]].forEach((([e,n])=>{const r=t.getElementsByClassName(e);console.assert(1===r.length,`Incorrect number of elements found with class: ${e}`),n(r[0].style)}))};const H={DrowpdownOpen:f,DropdownClose:S,Init:y},K=t=>{if(1!==t.length)return!1;const e=t[0];if("object"!=typeof e)return!1;const{text:n}=e;return n===d};function V(t,[{value:e}],n){const{id:r,customArgumentManager:i}=this,{component:a,id:o}=JSON.parse(e);switch(t[h]){case H.Init:return i.getCurrentEntries();case H.DropdownClose:{const t=i.tryResolve();return t?[[t.entry.text,t.id]]:i.getCurrentEntries()}case H.DrowpdownOpen:{const e=t[_],l=(s=function(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],a=t[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=a(n)):"call"!==i&&"optionalCall"!==i||(n=a(((...t)=>n.call(e,...t))),e=void 0)}return n}([e,"optionalAccess",t=>t.value]),c=()=>o,null!=s?s:c()),u=i.getEntry(l),[p,m]=i.request();return(async(t,e)=>{const n="blocklyDropDownContent",r=document.getElementsByClassName(n);if(1!==r.length)return console.error(`Uh oh! Expected 1 element with class '${n}', but found ${r.length}`);const[i]=r,a=await M((()=>i.children[0]));new t({target:i,anchor:a,props:e}),j(a)})(n(r,a),{setter:m,current:u,extension:this}),[["Apply",p]]}}var s,c;throw new Error("Error during processing -- Context:"+H)}class z{constructor(){z.prototype.__init.call(this),z.prototype.__init2.call(this)}__init(){this.map=new Map}__init2(){this.pending=null}clearPending(){this.pending=null}setPending(t){this.pending=t}add(t){const e=z.GetIdentifier();return this.map.set(e,t),this.clearPending(),e}insert(t,e){return this.map.set(t,e),this.clearPending(),t}request(){this.clearPending();const t=z.GetIdentifier();return[t,e=>this.setPending({id:t,entry:e})]}tryResolve(){if(!this.pending)return;const{pending:{entry:t,id:e}}=this;return this.map.set(e,t),this.clearPending(),{entry:t,id:e}}getCurrentEntries(){return Array.from(this.map.entries()).filter((([t,e])=>null!==e)).map((([t,{text:e}])=>[e,t]))}getEntry(t){return this.map.get(t)}static __initStatic(){this.SaveKey="internal_customArgumentsSaveData"}requiresSave(){this.map.size}saveTo(t){const e=Array.from(this.map.entries()).filter((([t,e])=>null!==e)).map((([t,e])=>({id:t,entry:e})));0!==e.length&&(t[z.SaveKey]=e)}loadFrom(t){!function(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],a=t[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=a(n)):"call"!==i&&"optionalCall"!==i||(n=a(((...t)=>n.call(e,...t))),e=void 0)}}([t,"access",t=>t[z.SaveKey],"optionalAccess",t=>t.forEach,"call",t=>t((({id:t,entry:e})=>{this.map.set(t,e)}))])}purgeStaleIDs(){}static __initStatic2(){this.IsIdentifier=t=>t.startsWith(z.IdentifierPrefix)}static __initStatic3(){this.GetIdentifier=()=>z.IdentifierPrefix+(new Date).getTime().toString()}static __initStatic4(){this.IdentifierPrefix="__customArg__"}}function J(t,e){return null!=t?t:e()}function W(t){let e,n=t[0],r=1;for(;r<t.length;){const i=t[r],a=t[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=a(n)):"call"!==i&&"optionalCall"!==i||(n=a(((...t)=>n.call(e,...t))),e=void 0)}return n}z.__initStatic(),z.__initStatic2(),z.__initStatic3(),z.__initStatic4();class X{__init(){this.saveDataHandler=void 0}__init2(){this.internal_blocks=[]}__init3(){this.internal_menus=[]}__init4(){this.keyByLegacyName=void 0}__init5(){this.argumentManager=null}get customArgumentManager(){return this.argumentManager}static __initStatic(){this.SaveDataKey="customSaveDataPerExtension"}save(t,e){const{saveDataHandler:n,id:r,argumentManager:i}=this,a=J(W([n,"optionalAccess",t=>t.hooks,"access",t=>t.onSave,"call",t=>t(this)]),(()=>({})));if(W([i,"optionalAccess",t=>t.saveTo,"call",t=>t(a)]),0===Object.keys(a).length)return;const o=t[X.SaveDataKey];o?o[r]=a:t[X.SaveDataKey]={[r]:a},e.add(r)}load(t){if(!t)return;const{saveDataHandler:e,id:n}=this,r=X.SaveDataKey in t?t[X.SaveDataKey][n]:null;r&&(W([e,"optionalAccess",t=>t.hooks,"access",t=>t.onLoad,"call",t=>t(this,r)]),(this.argumentManager??=new z).loadFrom(r))}openUI(t,e){const{id:n,name:r,runtime:i}=this;T(i,{id:n,name:r,component:t.replace(".svelte",""),label:e})}constructor(t,e){X.prototype.__init.call(this),X.prototype.__init2.call(this),X.prototype.__init3.call(this),X.prototype.__init4.call(this),X.prototype.__init5.call(this),X.prototype.__init6.call(this),X.prototype.__init7.call(this),X.prototype.__init8.call(this);const{name:n,id:r,blockIconURI:i}=J(e,(()=>this[X.InternalCodeGenArgsGetterKey]()));this.name=n,this.id=r,this.blockIconURI=i,this.runtime=t,X.ExtensionsByID.set(r,this)}internal_init(){this.init({runtime:this.runtime,videoFeed:W([this,"access",t=>t.runtime,"access",t=>t.ioDevices,"optionalAccess",t=>t.video])});const t=this.defineBlocks(),e=[],n=[];for(const r in t){const i=G(t[r])?t[r](this):t[r],a=this.convertToInfo(r,i,e,n);this.internal_blocks.push(a)}for(const[t,r]of e.entries()){let e=!1;const i=n[t];if(Array.isArray(r)){const t=r;this.addStaticMenu(t,e,i)}else if(G(r)){const t=r;this.addDynamicMenu(t,e,i)}else if(e=!0,"items"in r){const t=r;this.addStaticMenu(t.items,e,i)}else if("getItems"in r){const t=r;this.addDynamicMenu(t.getItems,e,i)}else;}}getInfo(){const{id:t,internal_blocks:e,internal_menus:n,name:r,blockIconURI:i}=this,a={id:t,blocks:e,name:r,blockIconURI:i};return n&&(a.menus=Object.values(this.internal_menus).reduce(((t,{name:e,...n})=>(t[e]=n,t)),{})),a}addStaticMenu(t,e,n){this.internal_menus.push({name:n,acceptReporters:e,items:t.map((t=>t)).map(X.ConvertMenuItemsToString)})}addDynamicMenu(t,e,n){const r=`internal_dynamic_${this.internal_menus.length}`;this[r]=()=>t().map((t=>t)).map(X.ConvertMenuItemsToString),this.internal_menus.push({acceptReporters:e,items:r,name:n})}convertToInfo(t,n,r,i){const{type:a,text:o,operation:s}=n,c=n.arg?[n.arg]:n.args,l=X.ExtractLegacyInformation(n),u=void 0!==l;u&&(this.keyByLegacyName?this.keyByLegacyName[t]=l.name:this.keyByLegacyName={[t]:l.name});const{displayText:p,orderedNames:m}=X.ConvertToDisplayText(this,t,o,c,u),{argumentsInfo:d,handlers:g}=J(X.ConvertToArgumentInfo(this,t,c,r,i),(()=>({argumentsInfo:void 0,handlers:void 0}))),h=u?l.name:X.GetInternalKey(t),_=s.bind(this),{id:y}=this,f=a===e.Button,S=f?X.GetButtonID(y,h):void 0;return f?I(this.runtime,S,_):this.registerOpcode(h,_,c,g,m,u),{opcode:h,text:p,blockType:a,arguments:d,func:S}}__init6(){this[g]=K.bind(this)}__init7(){this.processCustomArgumentHack=V.bind(this)}format(t,e,n){return t}registerOpcode(t,e,r,i,a,o){const{customArgumentManager:s}=this;this[t]=(t,c)=>{const l=(o?a.map((e=>t[e])):Object.values(t).slice(0,-1)).map(((t,e)=>{const a=X.GetArgumentType(r[e]),o=J(i[e],(()=>F));return a!==n.Custom?X.CastToType(a,o(t)):B(t)&&z.IsIdentifier(t)?o(s.getEntry(t).value):o(t)}));return e(...l,c)}}static __initStatic2(){this.GetExtensionByID=t=>{if(X.ExtensionsByID.has(t))return X.ExtensionsByID.get(t);console.error(`Could not find extension with id '${t}'`)}}static __initStatic3(){this.TryCastToArgumentType=(t,e,n)=>{try{return X.CastToType(t,e)}catch(t){return n(e)}}}__init8(){this.makeCustomArgument=({component:t,initial:e,acceptReportersHandler:r})=>{this.argumentManager??=new z;const i=this.argumentManager.add(e),a=()=>[{text:d,value:JSON.stringify({component:t,id:i})}];return{type:n.Custom,defaultValue:i,options:void 0===r?a:{acceptsReports:!0,getItems:a,handler:r}}}}static __initStatic4(){this.GetKeyFromOpcode=t=>t.replace(X.GetInternalKey(""),"")}static ConvertToDisplayText(t,e,n,r,i){const a=i?[]:void 0,o=G(n)?n(...r.map(((t,e)=>{const n=i?X.ExtractLegacyInformation(t).name:e;return i&&a.push(n),`[${n}]`}))):n;return{displayText:t.format(o,e,`Block text for '${e}'`),orderedNames:a}}static ConvertToArgumentInfo(t,e,n,r,i){if(!n)return;const a=n?new Array(n.length).fill(void 0):void 0;return{argumentsInfo:n.map(((n,o)=>{const s={};if(s.type=X.GetArgumentType(n),s.name=J(W([X,"access",t=>t.ExtractLegacyInformation,"call",t=>t(n),"optionalAccess",t=>t.name]),(()=>`${o}`)),$(n))return s;const{defaultValue:c,options:l}=n;if(void 0!==c&&(s.defaultValue=B(s)?t.format(c,X.GetArgTranslationID(e,o),`Default value for arg ${o+1} of ${e} block`):c),!l)return s;const u=r.indexOf(l),p=u>=0,m=p?u:r.push(l)-1,d=J(W([X,"access",t=>t.ExtractLegacyInformation,"call",t=>t(l),"optionalAccess",t=>t.name]),(()=>`${m}`));if(p||i.push(d),s.menu=d,"handler"in l){const{handler:t}=l;a[o]=t}return s})).reduce(((t,{name:e,...n})=>(t[e]=n,t)),{}),handlers:a}}static __initStatic5(){this.GetArgTranslationID=(t,e)=>`${t}-arg${e}-default`}static __initStatic6(){this.GetInternalKey=t=>`internal_${t}`}static __initStatic7(){this.GetButtonID=(t,e)=>`${t}_${e}`}static __initStatic8(){this.GetArgumentType=t=>$(t)?t:t.type}static __initStatic9(){this.ToFlag=t=>1===parseInt(t)}static __initStatic10(){this.ToMatrix=t=>{if(25!==t.length)return new Array(5).fill(new Array(5).fill(!1));return t.split("").map(X.ToFlag).reduce(((t,e,n)=>{const r=Math.floor(n/5);return 0===n%5?t[r]=[e]:t[r].push(e),t}),new Array(5))}}static __initStatic11(){this.CastToType=(t,e)=>{switch(t){case n.String:return`${e}`;case n.Number:return parseFloat(e);case n.Boolean:return JSON.parse(e);case n.Note:case n.Angle:return parseInt(e);case n.Matrix:return X.ToMatrix(e);case n.Color:return u.toRgbColorObject(e);default:throw new Error(`Method not implemented for value of ${e} and type ${t}`)}}}static __initStatic12(){this.ConvertMenuItemsToString=t=>$(t)?`${t}`:{...t,value:`${t.value}`}}static __initStatic13(){this.ExtensionsByID=new Map}static __initStatic14(){this.InternalCodeGenArgsGetterKey="internal_getCodeGenArgs"}static __initStatic15(){this.TestGetInfo=(t,...e)=>t.getInfo(...e)}static __initStatic16(){this.TestGetBlocks=(t,...e)=>t.getInfo(...e).blocks}static __initStatic17(){this.TestInit=(t,...e)=>t.internal_init(...e)}static __initStatic18(){this.ExtractLegacyInformation=t=>!$(t)&&"name"in t?{name:t.name}:void 0}static __initStatic19(){this.GetLegacyName=(t,e)=>W([t,"access",t=>t.keyByLegacyName,"optionalAccess",t=>t[e]])}}var q;X.__initStatic(),X.__initStatic2(),X.__initStatic3(),X.__initStatic4(),X.__initStatic5(),X.__initStatic6(),X.__initStatic7(),X.__initStatic8(),X.__initStatic9(),X.__initStatic10(),X.__initStatic11(),X.__initStatic12(),X.__initStatic13(),X.__initStatic14(),X.__initStatic15(),X.__initStatic16(),X.__initStatic17(),X.__initStatic18(),X.__initStatic19(),function(t){t.Arg="arg";t.Args="args"}(q||(q={}));const Z=new RegExp("^[a-z0-9]+$","i"),Q=new RegExp("[^a-z0-9]+","gi"),Y=["prg","prg".split("").reverse().join("")],tt=new RegExp(`${Y[0]}([0-9]+)${Y[1]}`,"g"),et=(t,e,n)=>t.replaceAll(e,n);const nt=(t,e,n,r,i)=>{if(t.name=e,!n)return;t.options.name=n;const a=r[n];if(!a)return;const o=a.items;if(!o||0===o.length)return;const s=Array.isArray(t.options)?t.options:G(t.options)?t.options():t.options.items?t.options.items:t.options.getItems(),c=t=>$(t)?{text:`${t}`,value:t}:t,l=t=>JSON.stringify(t),u=o.map(c).map(l),p=s.map(c).map(l);for(const t of u)if(!p.includes(t))throw new Error(`Mismatch in old and new menus for block ${i}: arg ${e}. Old entry: ${t}, new entries: [${p.join(", ")}]`)};return t.ArgumentType=n,t.BlockType=e,t.Branch={Exit:0,Enter:1,First:1,Second:2,Third:3,Fourth:4,Fifth:5,Sixth:6,Seventh:7},t.Extension=X,t.FrameworkID="ExtensionFramework",t.Language=a,t.LanguageKeys=o,t.LayerGroups=i,t.RuntimeEvent={ScriptGlowOn:"SCRIPT_GLOW_ON",ScriptGlowOff:"SCRIPT_GLOW_OFF",BlockGlowOn:"BLOCK_GLOW_ON",BlockGlowOff:"BLOCK_GLOW_OFF",HasCloudDataUpdate:"HAS_CLOUD_DATA_UPDATE",TurboModeOn:"TURBO_MODE_ON",TurboModeOff:"TURBO_MODE_OFF",RecordingOn:"RECORDING_ON",RecordingOff:"RECORDING_OFF",ProjectStart:"PROJECT_START",ProjectRunStart:"PROJECT_RUN_START",ProjectRunStop:"PROJECT_RUN_STOP",ProjectStopAll:"PROJECT_STOP_ALL",StopForTarget:"STOP_FOR_TARGET",VisualReport:"VISUAL_REPORT",ProjectLoaded:"PROJECT_LOADED",ProjectChanged:"PROJECT_CHANGED",ToolboxExtensionsNeedUpdate:"TOOLBOX_EXTENSIONS_NEED_UPDATE",TargetsUpdate:"TARGETS_UPDATE",MonitorsUpdate:"MONITORS_UPDATE",BlockDragUpdate:"BLOCK_DRAG_UPDATE",BlockDragEnd:"BLOCK_DRAG_END",ExtensionAdded:"EXTENSION_ADDED",ExtensionFieldAdded:"EXTENSION_FIELD_ADDED",PeripheralListUpdate:"PERIPHERAL_LIST_UPDATE",PeripheralConnected:"PERIPHERAL_CONNECTED",PeripheralDisconnected:"PERIPHERAL_DISCONNECTED",PeripheralRequestError:"PERIPHERAL_REQUEST_ERROR",PeripheralConnectionLostError:"PERIPHERAL_CONNECTION_LOST_ERROR",PeripheralScanTimeout:"PERIPHERAL_SCAN_TIMEOUT",MicListening:"MIC_LISTENING",BlocksInfoUpdate:"BLOCKSINFO_UPDATE",RuntimeStarted:"RUNTIME_STARTED",RuntimeDisposed:"RUNTIME_DISPOSED",BlocksNeedUpdate:"BLOCKS_NEED_UPDATE"},t.SaveDataHandler=class{constructor(t){this.hooks=t}},t.ScratchBlocksConstants={OutputShapeHexagonal:1,OutputShapeRound:2,OutputShapeSquare:3},t.StageLayering=r,t.TargetType={Sprite:"sprite",Stage:"stage"},t.VariableType={Scalar:"",List:"list",BrooadcastMessage:"broadcast_msg"},t.activeClass=!0,t.closeDropdownState=S,t.color=P,t.copyTo=({target:t,source:e})=>{for(const n in e)n in t&&(t[n]=e[n])},t.customArgumentCheck=g,t.customArgumentFlag=d,t.decode=t=>[...[...t.matchAll(tt)].reduce(((t,e)=>{const[n,r]=e;return t.set(n,String.fromCharCode(r))}),new Map)].reduce(((t,[e,n])=>et(t,e,n)),`${t}`),t.dropdownEntryFlag=_,t.dropdownStateFlag=h,t.encode=t=>[...[...t.matchAll(Q)].reduce(((t,e)=>(e[0].split("").forEach((e=>t.add(e))),t)),new Set)].map((t=>({char:t,code:t.charCodeAt(0)}))).reduce(((t,{char:e,code:n})=>et(t,e,`${Y[0]}${n}${Y[1]}`)),`${t}`),t.extractLegacySupportFromOldGetInfo=t=>{const{blocks:e,menus:n}=t,r=e.filter((t=>!B(t))).map((t=>[t.opcode,e=>((t,e,n,r)=>{const i=e;if(e.name=t,"arg"in i){const[e,{menu:a}]=Object.entries(n.arguments)[0];nt(i.arg,e,a,r,t)}else if("args"in i){const e=Object.entries(n.arguments);for(let n=0;n<e.length;n++){const[a,{menu:o}]=e[n];nt(i.args[n],a,o,r,t)}}return e})(t.opcode,e,t,n)])).reduce(((t,[e,n])=>(t[e]=n,t)),{});return r.tsIgnore=r,r.legacyBlocksForTests=e.reduce(((t,e)=>(t[e.opcode]=e,t)),{}),r},t.fetchWithTimeout=async function(t,e){const{timeout:n}=e,r=new AbortController,i=setTimeout((()=>r.abort()),n),a=await fetch(t,{...e,signal:r.signal});return clearTimeout(i),a},t.getTextFromMenuItem=t=>"object"==typeof t?t.text:t,t.getValueFromMenuItem=t=>"object"==typeof t?t.value:t,t.identity=F,t.initDropdownState=y,t.isFunction=G,t.isPrimitive=$,t.isString=B,t.isValidID=t=>Z.test(t),t.loadExternalScript=(t,e,n)=>{const r=document.createElement("script");var i,a;r.onload=e,r.onerror=(a=()=>()=>{throw new Error(`Error loading endpoint: ${t}`)},null!=(i=n)?i:a()),r.src=t,r.async=!0,document.body.appendChild(r)},t.mockFormatMessage=t=>"",t.openDropdownState=f,t.openUI=T,t.openUIEvent=p,t.px=t=>`${t}px`,t.reactiveInvoke=(t,e,n)=>t[e](...n),t.reactiveSet=(t,e,n)=>{t[e]=n},t.registerButtonCallback=I,t.registerButtonCallbackEvent=m,t.splitOnCapitals=t=>t.split(/(?=[A-Z])/),t.untilCondition=async function(t,e=100){let n;for(;!t();)await new Promise((t=>{clearTimeout(n),n=setTimeout(t,e)}));clearTimeout(n)},t.untilExternalGlobalVariableLoaded=async(t,e)=>(window[e]||await U(t),window[e]),t.untilExternalScriptLoaded=U,t.untilObject=M,t.untilReady=async function(t,e=100){let n;for(;!t.ready;)await new Promise((t=>{clearTimeout(n),n=setTimeout(t,e)}));clearTimeout(n)},Object.defineProperty(t,"__esModule",{value:!0}),t}({});//# sourceMappingURL=ExtensionFramework.js.map
