var ExtensionFramework=function(e){"use strict";class t{constructor(){this.map=new Map,this.pending=null}clearPending(){this.pending=null}setPending(e){this.pending=e}add(e){const r=t.GetIdentifier();return this.map.set(r,e),this.clearPending(),r}insert(e,t){return this.map.set(e,t),this.clearPending(),e}request(){this.clearPending();const e=t.GetIdentifier();return[e,t=>this.setPending({id:e,entry:t})]}tryResolve(){if(!this.pending)return;const{pending:{entry:e,id:t}}=this;return this.map.set(t,e),this.clearPending(),{entry:e,id:t}}getCurrentEntries(){return Array.from(this.map.entries()).filter((([e,t])=>null!==t)).map((([e,{text:t}])=>[t,e]))}getEntry(e){return this.map.get(e)}requiresSave(){this.map.size}saveTo(e){const r=Array.from(this.map.entries()).filter((([e,t])=>null!==t)).map((([e,t])=>({id:e,entry:t})));0!==r.length&&(e[t.SaveKey]=r)}loadFrom(e){e[t.SaveKey]?.forEach((({id:e,entry:t})=>{this.map.set(e,t)}))}purgeStaleIDs(){}}t.SaveKey="internal_customArgumentsSaveData",t.IsIdentifier=e=>e.startsWith(t.IdentifierPrefix),t.GetIdentifier=()=>t.IdentifierPrefix+(new Date).getTime().toString(),t.IdentifierPrefix="__customArg__";const r="customSaveDataPerExtension";const n={Boolean:"Boolean",Button:"button",Command:"command",Conditional:"conditional",Event:"event",Hat:"hat",Loop:"loop",Reporter:"reporter"},a={Angle:"angle",Boolean:"Boolean",Color:"color",Number:"number",String:"string",Matrix:"matrix",Note:"note",Image:"image",Custom:"custom"},o={BackgroundLayer:"background",VideoLayer:"video",PenLayer:"pen",SpriteLayer:"sprite"},i=[o.VideoLayer,o.SpriteLayer,o.BackgroundLayer,o.PenLayer],s={"Аҧсшәа":"ab","العربية":"ar","አማርኛ":"am",Azeri:"az",Bahasa_Indonesia:"id","Беларуская":"be","Български":"bg","Català":"ca","Česky":"cs",Cymraeg:"cy",Dansk:"da",Deutsch:"de",Eesti:"et","Ελληνικά":"el",English:"en","Español":"es","Español_Latinoamericano":"es-419",Euskara:"eu","فارسی":"fa","Français":"fr",Gaeilge:"ga","Gàidhlig":"gd",Galego:"gl","한국어":"ko","עִבְרִית":"he",Hrvatski:"hr",isiZulu:"zu","Íslenska":"is",Italiano:"it","ქართული_ენა":"ka",Kiswahili:"sw","Kreyòl_ayisyen":"ht","کوردیی_ناوەندی":"ckb","Latviešu":"lv","Lietuvių":"lt",Magyar:"hu","Māori":"mi",Nederlands:"nl","日本語":"ja","にほんご":"ja-Hira","Norsk_Bokmål":"nb",Norsk_Nynorsk:"nn","Oʻzbekcha":"uz","ไทย":"th","ភាសាខ្មែរ":"km",Polski:"pl","Português":"pt","Português_Brasileiro":"pt-br",Rapa_Nui:"rap","Română":"ro","Русский":"ru","Српски":"sr","Slovenčina":"sk","Slovenščina":"sl",Suomi:"fi",Svenska:"sv","Tiếng_Việt":"vi","Türkçe":"tr","Українська":"uk","简体中文":"zh-cn","繁體中文":"zh-tw"},c=Object.keys(s);class l{static get RGB_BLACK(){return{r:0,g:0,b:0}}static get RGB_WHITE(){return{r:255,g:255,b:255}}static decimalToHex(e){e<0&&(e+=16777216);let t=Number(e).toString(16);return t=`#${"000000".substr(0,6-t.length)}${t}`,t}static decimalToRgb(e){const t=e>>24&255;return{r:e>>16&255,g:e>>8&255,b:255&e,a:t>0?t:255}}static hexToRgb(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,r,n)=>t+t+r+r+n+n));const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}static rgbToHex(e){return l.decimalToHex(l.rgbToDecimal(e))}static rgbToDecimal(e){return(e.r<<16)+(e.g<<8)+e.b}static hexToDecimal(e){return l.rgbToDecimal(l.hexToRgb(e))}static hsvToRgb(e){let t=e.h%360;t<0&&(t+=360);const r=Math.max(0,Math.min(e.s,1)),n=Math.max(0,Math.min(e.v,1)),a=Math.floor(t/60),o=t/60-a,i=n*(1-r),s=n*(1-r*o),c=n*(1-r*(1-o));let l,u,p;switch(a){default:case 0:l=n,u=c,p=i;break;case 1:l=s,u=n,p=i;break;case 2:l=i,u=n,p=c;break;case 3:l=i,u=s,p=n;break;case 4:l=c,u=i,p=n;break;case 5:l=n,u=i,p=s}return{r:Math.floor(255*l),g:Math.floor(255*u),b:Math.floor(255*p)}}static rgbToHsv(e){const t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(Math.min(t,r),n),o=Math.max(Math.max(t,r),n);let i=0,s=0;if(a!==o){i=60*((t===a?3:r===a?5:1)-(t===a?r-n:r===a?n-t:t-r)/(o-a))%360,s=(o-a)/o}return{h:i,s:s,v:o}}static mixRgb(e,t,r){if(r<=0)return e;if(r>=1)return t;const n=1-r;return{r:n*e.r+r*t.r,g:n*e.g+r*t.g,b:n*e.b+r*t.b}}}const u=l;class p{static toNumber(e){if("number"==typeof e)return Number.isNaN(e)?0:e;const t=Number(e);return Number.isNaN(t)?0:t}static toBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e.toLowerCase():Boolean(e)}static toString(e){return String(e)}static toRgbColorList(e){const t=p.toRgbColorObject(e);return[t.r,t.g,t.b]}static toRgbColorObject(e){let t;return"string"==typeof e&&"#"===e.substring(0,1)?(t=u.hexToRgb(e),t||(t={r:0,g:0,b:0,a:255})):t=u.decimalToRgb(p.toNumber(e)),t}static isWhiteSpace(e){return null===e||"string"==typeof e&&0===e.trim().length}static compare(e,t){let r=Number(e),n=Number(t);if(0===r&&p.isWhiteSpace(e)?r=NaN:0===n&&p.isWhiteSpace(t)&&(n=NaN),isNaN(r)||isNaN(n)){const r=String(e).toLowerCase(),n=String(t).toLowerCase();return r<n?-1:r>n?1:0}return r===1/0&&n===1/0||r===-1/0&&n===-1/0?0:r-n}static isInt(e){return"number"==typeof e?!!isNaN(e)||e===parseInt(e,10):"boolean"==typeof e||"string"==typeof e&&e.indexOf(".")<0}static get LIST_INVALID(){return"INVALID"}static get LIST_ALL(){return"ALL"}static toListIndex(e,t,r){if("number"!=typeof e){if("all"===e)return r?p.LIST_ALL:p.LIST_INVALID;if("last"===e)return t>0?t:p.LIST_INVALID;if("random"===e||"any"===e)return t>0?1+Math.floor(Math.random()*t):p.LIST_INVALID}return(e=Math.floor(p.toNumber(e)))<1||e>t?p.LIST_INVALID:e}}var m=p;const d=(e,t)=>{switch(e){case a.String:return`${t}`;case a.Number:return parseFloat(t);case a.Boolean:return JSON.parse(t);case a.Note:case a.Angle:return parseInt(t);case a.Matrix:return h(t);case a.Color:return m.toRgbColorObject(t);default:throw new Error(`Method not implemented for value of ${t} and type ${e}`)}},g=e=>1===parseInt(e),h=e=>{if(25!==e.length)return new Array(5).fill(new Array(5).fill(!1));return e.split("").map(g).reduce(((e,t,r)=>{const n=Math.floor(r/5);return 0===r%5?e[n]=[t]:e[n].push(t),e}),new Array(5))},f="OPEN_UI_FROM_EXTENSION",y="REGISTER_BUTTON_CALLBACK_FROM_EXTENSION",E="internal_IsCustomArgument",b="isCustomArgumentHack",T="dropdownState",w="dropdownEntry",I="init",S="open",O="close",_=(e,t)=>e.emit(f,t),R=(e,t,r)=>{e.emit(y,t),e.on(t,r)};class x{constructor(e){this.root=e}get(...e){return`var(--${this.root}-${e.join("-")})`}primary(...e){return this.get("primary",...e)}secondary(...e){return this.get("secondary",...e)}tertiary(...e){return this.get("tertiary",...e)}transparent(...e){return this.get("transparent",...e)}light(...e){return this.get("light",...e)}}const N=new x("ui"),D=new x("text"),A=new x("motion"),k=new x("red"),C=new x("sound"),L=new x("control"),v=new x("data"),M=new x("pen"),P=new x("error"),B=new x("extensions"),$=new x("extensions"),F={ui:{primary:N.primary(),secondary:N.secondary(),tertiary:N.tertiary(),modalOverlay:N.get("modal","overlay"),white:N.get("white"),whiteDim:N.get("white","dim"),whiteTransparent:N.get("white","transparent"),transparent:N.transparent(),blackTransparent:N.get("black","transparent")},text:{primary:D.primary(),primaryTransparent:D.transparent()},motion:{primary:A.primary(),tertiary:A.tertiary(),transparent:A.get("transparent"),lightTansparent:A.light("transparent")},red:{primary:k.primary(),tertiary:k.tertiary()},sound:{primary:C.primary(),tertiary:C.tertiary()},control:{primary:L.primary()},data:{primary:v.primary()},pen:{primary:M.primary(),transparent:M.transparent()},error:{primary:P.primary(),light:P.light(),transparent:P.transparent()},extensions:{primary:B.primary(),tertiary:B.tertiary(),light:B.light(),transparent:B.transparent()},drop:{highlight:$.get("highlight")}};async function U(e,t=100){let r,n=e();for(;!n;)await new Promise((e=>{clearTimeout(r),r=setTimeout(e,t)})),n=e();return clearTimeout(r),n}const j=e=>"string"==typeof e||e instanceof String,G=e=>"[object Function]"===Object.prototype.toString.call(e)||"function"==typeof e||e instanceof Function,H=e=>e!==Object(e),V=e=>e,K=async e=>{const t=new Promise(((t,r)=>{const n=document.createElement("script");n.onload=t,n.onerror=r,n.async=!0,n.src=e,document.body.appendChild(n)}));await t},W=(e,t,...r)=>e.call(t,...r),z=e=>H(e)?e:e.type,J=e=>`internal_${e}`,q=(e,r,n)=>function(o,i){const s=n.map((({name:e,type:r,handler:n})=>{const i=o[e];if(r===a.Custom){return n(j(i)&&t.IsIdentifier(i)?this.customArgumentManager.getEntry(i).value:i)}return d(r,n(i))}));return r.call(e,...s,i)};const X=e=>{const t="args";return"arg"in e&&e.arg?[e.arg]:t in e&&(e[t]?.length??0)>0?e.args:[]},Z=(e,t)=>{const r=e.map(z),n=ue(e);return t??(t=r.map(((e,t)=>oe(t)))),Q(r,n,t),r.map(((e,r)=>({type:e,name:t[r],handler:n[r]})))},Q=(...e)=>{const{size:t}=e.reduce(((e,{length:t})=>e.add(t)),new Set);if(1!==t)throw new Error("Zip failed because collections weren't equal length")},Y=e=>G(e),ee=(e,t,r)=>e,te=e=>H(e)?`${e}`:{...e,value:`${e.value}`},re=(e,t)=>`${e}_${t}`,ne=(e,t,r)=>{if(!r||0===r.length)return t;if(le(t,r.length),!(e=>!j(e))(t))return ee(t);const n=t,a=r.map(((e,t)=>`[${oe(t)}]`));return ee(n(...a))},ae=(e,t,r)=>{if(t&&0!==t.length)return Object.fromEntries(t.map(((t,n)=>{const a={};if(a.type=z(t),H(t))return a;const{defaultValue:o,options:i}=t;return se(a,e,n,o),ce(a,i,r),a})).reduce(((e,t,r)=>e.set(oe(r),t)),new Map))},oe=e=>`${e}`,ie=e=>`${e}`,se=(e,t,r,n)=>{void 0!==n&&(e.defaultValue=((e,t,r)=>j(e)?ee(e):e)(n))},ce=(e,t,r)=>t?e.menu=((e,t)=>{const r=t.indexOf(e),n=r>=0?r:t.push(e)-1;return`${ie(n)}`})(t,r):null,le=(e,t)=>!0,ue=e=>e.map((e=>{if(H(e))return V;const{options:t}=e;return(e=>e&&"handler"in e)(t)?t.handler:V})),pe={isSimpleStatic:e=>Array.isArray(e),isSimpleDynamic:e=>G(e),isStaticWithReporters:e=>"items"in e,isDynamicWithReporters:e=>"getItems"in e},me=(e,t)=>({acceptReporters:t,items:e.map((e=>e)).map(te)}),de=async(e,t)=>{const r="blocklyDropDownContent",n=document.getElementsByClassName(r);if(1!==n.length)return console.error(`Uh oh! Expected 1 element with class '${r}', but found ${n.length}`);const[a]=n,o=await U((()=>a.children[0]));new e({target:a,anchor:o,props:t}),ge(o)},ge=e=>{[["goog-menuitem goog-option",e=>{e.margin="auto",e.paddingLeft=e.paddingRight="0px"}],["goog-menuitem-content",e=>e.textAlign="center"]].forEach((([t,r])=>{const n=e.getElementsByClassName(t);console.assert(1===n.length,`Incorrect number of elements found with class: ${t}`),r(n[0].style)}))},he={DrowpdownOpen:S,DropdownClose:O,Init:I};class fe{internal_init(){this.init({runtime:this.runtime,videoFeed:this.runtime.ioDevices?.video})}constructor(e,t,r,n){this.runtime=e,this.name=t,this.id=r,this.blockIconURI=n}}const ye=e=>{return function(e){return class extends e{constructor(){super(...arguments),this.blockMap=new Map,this.menus=[]}pushBlock(e,t,r){if(this.blockMap.has(e))throw new Error(`Attempt to push block with opcode ${e}, but it was already set. This is assumed to be a mistake.`);this.blockMap.set(e,{definition:t,operation:r})}getInfo(){if(!this.info){const{id:e,name:t,blockIconURI:r}=this,n=Array.from(this.blockMap.entries()).map((e=>this.convertToInfo(e)));this.info={id:e,blocks:n,name:t,blockIconURI:r,menus:this.collectMenus()}}return this.info}convertToInfo(e){const[t,r]=e,{definition:a,operation:o}=r,i=Y(a)?W(a,this,this):a,{type:s,text:c}=i,l=X(i),{id:u,runtime:p,menus:m}=this,d={opcode:t,text:ne(t,c,l),blockType:s,arguments:ae(t,l,m)};if(s===n.Button){const e=re(u,t);R(p,e,o.bind(this)),d.func=e}else this[J(t)]=q(this,o,Z(l));return d}collectMenus(){const{isSimpleStatic:e,isSimpleDynamic:t,isStaticWithReporters:r,isDynamicWithReporters:n}=pe;return Object.fromEntries(this.menus.map(((a,o)=>{if(e(a))return me(a,!1);if(t(a))return this.registerDynamicMenu(a,!1,o);if(r(a))return me(a.items,!0);if(n(a))return this.registerDynamicMenu(a.getItems,!0,o);throw new Error("Unable to process menu")})).reduce(((e,t,r)=>e.set(ie(r),t)),new Map))}registerDynamicMenu(e,t,r){const n=`internal_dynamic_${r}`;return this[n]=()=>e().map((e=>e)).map(te),{acceptReporters:t,items:n}}}}(function(e){return class extends e{constructor(){super(...arguments),this.saveDataHandler=void 0}save(e,t){const{saveDataHandler:n,id:a,argumentManager:o}=this,i=n?.hooks.onSave(this)??{};if(o?.saveTo(i),0===Object.keys(i).length)return;const s=e[r];s?s[a]=i:e[r]={[a]:i},t.add(a)}load(e){if(!e)return;const{saveDataHandler:n,id:a}=this,o=r in e?e[r][a]:null;o&&(n?.hooks.onLoad(this,o),(this.argumentManager??(this.argumentManager=new t)).loadFrom(o))}}}(function(e){return class extends e{constructor(){super(...arguments),this.makeCustomArgument=({component:e,initial:r,acceptReportersHandler:n})=>{this.argumentManager??(this.argumentManager=new t);const o=this.argumentManager.add(r),i=()=>[{text:E,value:JSON.stringify({component:e,id:o})}];return{type:a.Custom,defaultValue:o,options:void 0===n?i:{acceptsReports:!0,getItems:i,handler:n}}},this.argumentManager=null}get customArgumentManager(){return this.argumentManager}[b](e){if(1!==e.length)return!1;const t=e[0];if("object"!=typeof t)return!1;const{text:r}=t;return r===E}processCustomArgumentHack(e,[{value:t}],r){const{id:n,customArgumentManager:a}=this,{component:o,id:i}=JSON.parse(t);switch(e[T]){case he.Init:return a.getCurrentEntries();case he.DropdownClose:{const e=a.tryResolve();return e?[[e.entry.text,e.id]]:a.getCurrentEntries()}case he.DrowpdownOpen:{const t=e[w],s=t?.value??i,c=a.getEntry(s),[l,u]=a.request();return de(r(n,o),{setter:u,current:c,extension:this}),[["Apply",l]]}}throw new Error("Error during processing -- Context:"+he)}}}((o=e,class extends o{openUI(e,t){const{id:r,name:n,runtime:a}=this;_(a,{id:r,name:n,component:e.replace(".svelte",""),label:t})}}))));var o},Ee=new Map;class be extends(ye(fe)){constructor(e){super(...arguments)}}const Te=e=>`__block_${e}`;const we=new RegExp("^[a-z0-9]+$","i"),Ie=new RegExp("[^a-z0-9]+","gi"),Se=["prg","prg".split("").reverse().join("")],Oe=new RegExp(`${Se[0]}([0-9]+)${Se[1]}`,"g"),_e=(e,t,r)=>e.replaceAll(t,r),Re=(e,t,r,n,a)=>{if(e.name=t,!r)return;e.options.name=r;const o=n[r];if(!o)return;const i=o.acceptReporters;if(i!==(e.options.acceptsReporters??!1))throw new Error(`The new options provided for the legacy block '${a}' for legacy argument '${t}' ${i?"should":"should NOT"} accept reporters`);const s=o.items;if(!s||0===s.length)return;const c=Array.isArray(e.options)?e.options:G(e.options)?e.options():e.options.items?e.options.items:e.options.getItems(),l=e=>H(e)?{text:`${e}`,value:e}:e,u=e=>JSON.stringify(e),p=s.map(l).map(u),m=c.map(l).map(u);for(const e of p)if(!m.includes(e))throw new Error(`Mismatch in old and new menus for block ${a}: arg ${t}. Old entry: ${e}, new entries: [${m.join(", ")}]`)};function xe(e){return function(t,r){const n=t.name,a=J(n);return r.addInitializer((function(){this.pushBlock(n,e,t)})),function(){return this[a].call(this,...arguments)}}}const Ne="__registerMenuDetials";const De=e=>Array.from(e.blocks.map((e=>{if(j(e))throw new Error(`Block defined as string, unexpected! ${e}`);return e})).reduce(((t,r)=>{const{opcode:n,arguments:a,blockType:o}=r,{text:i,orderedNames:s}=Ae(r),c=Object.entries(a).map((([t,{type:r,defaultValue:n,menu:a}])=>({name:t,defaultValue:n,type:r,options:Ce(e,a)}))).sort((({name:e},{name:t})=>s.indexOf(e)<s.indexOf(t)?-1:1)).map((({name:e,...t})=>t)),{length:l}=c,u=l>=2?{args:c}:1===l?{arg:c[0]}:{};return t.set(n,{type:o,text:i,...u})}),new Map).entries()),Ae=({arguments:e,text:t})=>{const r=Object.keys(e).map((e=>({name:e,template:`[${e}]`}))).sort((({template:e},{template:r})=>t.indexOf(e)<t.indexOf(r)?-1:1));return 0===r.length?{orderedNames:void 0,text:t}:{orderedNames:r.map((({name:e})=>e)),text:()=>r.reduce(((e,{template:t},r)=>e.replace(t,`[${oe(r)}]`)),t)}},ke=e=>j(e),Ce=(e,t)=>{if(!t||!e.menus[t])return;const r=e.menus[t];if(ke(r))throw new Error(`Menu '${t}' is dynamic, not supported.`);const{items:n,acceptReporters:a}=r;if(ke(n))throw new Error(`Items is dynamic for menu '${t}', not supported: `);if(!n)throw new Error(`Empty items for menu '${t}'!`);return a?{acceptsReporters:a,items:[...n],handler:V}:[...n]};return e.ArgumentType=a,e.BlockType=n,e.Branch={Exit:0,Enter:1,First:1,Second:2,Third:3,Fourth:4,Fifth:5,Sixth:6,Seventh:7},e.CustomArgumentManager=t,e.DecoratedExtension=class extends be{constructor(){super(...arguments),this.version="decorated"}},e.Extension=class extends be{constructor(){super(...arguments),this.version="generic"}internal_init(){super.internal_init();const e=this.defineBlocks(),t=this;for(const r in e){const n=e[r],a=r in this?Te(r):r,{operation:o,text:i,arg:s,args:c,type:l}=G(n)?n.call(this,this):n;this.pushBlock(a,{text:i,arg:s,args:c,type:l},o);const u=J(a);this[a]=function(){return t[u].call(t,...arguments)}}}},e.ExtensionBase=fe,e.ExtensionCommon=be,e.FrameworkID="ExtensionFramework",e.Language=s,e.LanguageKeys=c,e.LayerGroups=i,e.RuntimeEvent={ScriptGlowOn:"SCRIPT_GLOW_ON",ScriptGlowOff:"SCRIPT_GLOW_OFF",BlockGlowOn:"BLOCK_GLOW_ON",BlockGlowOff:"BLOCK_GLOW_OFF",HasCloudDataUpdate:"HAS_CLOUD_DATA_UPDATE",TurboModeOn:"TURBO_MODE_ON",TurboModeOff:"TURBO_MODE_OFF",RecordingOn:"RECORDING_ON",RecordingOff:"RECORDING_OFF",ProjectStart:"PROJECT_START",ProjectRunStart:"PROJECT_RUN_START",ProjectRunStop:"PROJECT_RUN_STOP",ProjectStopAll:"PROJECT_STOP_ALL",StopForTarget:"STOP_FOR_TARGET",VisualReport:"VISUAL_REPORT",ProjectLoaded:"PROJECT_LOADED",ProjectChanged:"PROJECT_CHANGED",ToolboxExtensionsNeedUpdate:"TOOLBOX_EXTENSIONS_NEED_UPDATE",TargetsUpdate:"TARGETS_UPDATE",MonitorsUpdate:"MONITORS_UPDATE",BlockDragUpdate:"BLOCK_DRAG_UPDATE",BlockDragEnd:"BLOCK_DRAG_END",ExtensionAdded:"EXTENSION_ADDED",ExtensionFieldAdded:"EXTENSION_FIELD_ADDED",PeripheralListUpdate:"PERIPHERAL_LIST_UPDATE",PeripheralConnected:"PERIPHERAL_CONNECTED",PeripheralDisconnected:"PERIPHERAL_DISCONNECTED",PeripheralRequestError:"PERIPHERAL_REQUEST_ERROR",PeripheralConnectionLostError:"PERIPHERAL_CONNECTION_LOST_ERROR",PeripheralScanTimeout:"PERIPHERAL_SCAN_TIMEOUT",MicListening:"MIC_LISTENING",BlocksInfoUpdate:"BLOCKSINFO_UPDATE",RuntimeStarted:"RUNTIME_STARTED",RuntimeDisposed:"RUNTIME_DISPOSED",BlocksNeedUpdate:"BLOCKS_NEED_UPDATE"},e.SaveDataHandler=class{constructor(e){this.hooks=e}},e.ScratchBlocksConstants={OutputShapeHexagonal:1,OutputShapeRound:2,OutputShapeSquare:3},e.StageLayering=o,e.TargetType={Sprite:"sprite",Stage:"stage"},e.VariableType={Scalar:"",List:"list",BrooadcastMessage:"broadcast_msg"},e.activeClass=!0,e.block=xe,e.buttonBlock=function(e){return xe({text:e,type:n.Button})},e.castToType=d,e.closeDropdownState=O,e.color=F,e.copyTo=({target:e,source:t})=>{for(const r in t)r in e&&(e[r]=t[r])},e.customArgumentCheck=b,e.customArgumentFlag=E,e.decode=e=>[...[...e.matchAll(Oe)].reduce(((e,t)=>{const[r,n]=t;return e.set(r,String.fromCharCode(n))}),new Map)].reduce(((e,[t,r])=>_e(e,t,r)),`${e}`),e.dropdownEntryFlag=w,e.dropdownStateFlag=T,e.encode=e=>[...[...e.matchAll(Ie)].reduce(((e,t)=>(t[0].split("").forEach((t=>e.add(t))),e)),new Set)].map((e=>({char:e,code:e.charCodeAt(0)}))).reduce(((e,{char:t,code:r})=>_e(e,t,`${Se[0]}${r}${Se[1]}`)),`${e}`),e.extension=function(e){return t=>{"undefined"==typeof window&&global?.[Ne]?.(e)}},e.extensionsMap=Ee,e.extractLegacySupportFromOldGetInfo=e=>{const{blocks:t,menus:r}=e,n=t.filter((e=>!j(e))).map((e=>[e.opcode,t=>((e,t,r,n)=>{const a=t;if(t.name=e,"arg"in a){const[t,{menu:o}]=Object.entries(r.arguments)[0];Re(a.arg,t,o,n,e)}else if("args"in a){const t=Object.entries(r.arguments);for(let r=0;r<t.length;r++){const[o,{menu:i}]=t[r];Re(a.args[r],o,i,n,e)}}return t})(e.opcode,t,e,r)])).reduce(((e,[t,r])=>(e[t]=r,e)),{});return n.tsIgnore=n,n.legacyBlocksForTests=t.reduce(((e,t)=>(e[t.opcode]=t,e)),{}),n},e.fetchWithTimeout=async function(e,t){const{timeout:r}=t,n=new AbortController,a=setTimeout((()=>n.abort()),r),o=await fetch(e,{...t,signal:n.signal});return clearTimeout(a),o},e.getAlternativeOpcodeName=Te,e.getTextFromMenuItem=e=>"object"==typeof e?e.text:e,e.getValueFromMenuItem=e=>"object"==typeof e?e.value:e,e.identity=V,e.initDropdownState=I,e.isFunction=G,e.isPrimitive=H,e.isString=j,e.isValidID=e=>we.test(e),e.legacyFactory=e=>{const t=De(e);return{extensionDecorator:()=>function(t,r){class n extends(function(e,t){return class extends e{getInfo(){if(!this.validatedInfo){const{getInfo:e}=be.prototype,t=e.call(this);this.validatedInfo=this.validateAndAttach(t)}return this.validatedInfo}validateAndAttach({id:e,blocks:r}){const{id:n,blocks:a}=t;if(e!==n)throw new Error("ID mismatch! IDs should match ");return t}}}(t,e)){constructor(){super(...arguments),this.originalClassName=r.name}}return n},blockDefinitions:t.reduce(((e,[t,r])=>(e[t]=(e,t)=>({...r,operation:t}),e)),{}),blockDecorators:t.reduce(((e,[t,r])=>(e[t]=()=>xe(r),e)),{})}},e.loadExternalScript=(e,t,r)=>{const n=document.createElement("script");n.onload=t,n.onerror=r??(()=>{throw new Error(`Error loading endpoint: ${e}`)}),n.src=e,n.async=!0,document.body.appendChild(n)},e.mockFormatMessage=e=>"",e.openDropdownState=S,e.openUI=_,e.openUIEvent=f,e.px=e=>`${e}px`,e.reactiveInvoke=(e,t,r)=>e[t](...r),e.reactiveSet=(e,t,r)=>{e[t]=r},e.registerButtonCallback=R,e.registerButtonCallbackEvent=y,e.registerExtensionDefinitionCallback=e=>global[Ne]=t=>{e(t),delete global[Ne]},e.renderToDropdown=de,e.splitOnCapitals=e=>e.split(/(?=[A-Z])/),e.tryCastToArgumentType=(e,t,r)=>{try{return d(e,t)}catch{return r(t)}},e.typesafeCall=W,e.untilCondition=async function(e,t=100){let r;for(;!e();)await new Promise((e=>{clearTimeout(r),r=setTimeout(e,t)}));clearTimeout(r)},e.untilExternalGlobalVariableLoaded=async(e,t)=>(window[t]||await K(e),window[t]),e.untilExternalScriptLoaded=K,e.untilObject=U,e.untilReady=async function(e,t=100){let r;for(;!e.ready;)await new Promise((e=>{clearTimeout(r),r=setTimeout(e,t)}));clearTimeout(r)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});//# sourceMappingURL=ExtensionFramework.js.map
