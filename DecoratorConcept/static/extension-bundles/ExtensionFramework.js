var ExtensionFramework=function(t){"use strict";class e{constructor(){this.map=new Map,this.pending=null}clearPending(){this.pending=null}setPending(t){this.pending=t}add(t){const r=e.GetIdentifier();return this.map.set(r,t),this.clearPending(),r}insert(t,e){return this.map.set(t,e),this.clearPending(),t}request(){this.clearPending();const t=e.GetIdentifier();return[t,e=>this.setPending({id:t,entry:e})]}tryResolve(){if(!this.pending)return;const{pending:{entry:t,id:e}}=this;return this.map.set(e,t),this.clearPending(),{entry:t,id:e}}getCurrentEntries(){return Array.from(this.map.entries()).filter((([t,e])=>null!==e)).map((([t,{text:e}])=>[e,t]))}getEntry(t){return this.map.get(t)}requiresSave(){this.map.size}saveTo(t){const r=Array.from(this.map.entries()).filter((([t,e])=>null!==e)).map((([t,e])=>({id:t,entry:e})));0!==r.length&&(t[e.SaveKey]=r)}loadFrom(t){t[e.SaveKey]?.forEach((({id:t,entry:e})=>{this.map.set(t,e)}))}purgeStaleIDs(){}}e.SaveKey="internal_customArgumentsSaveData",e.IsIdentifier=t=>t.startsWith(e.IdentifierPrefix),e.GetIdentifier=()=>e.IdentifierPrefix+(new Date).getTime().toString(),e.IdentifierPrefix="__customArg__";const r="customSaveDataPerExtension";const n={Boolean:"Boolean",Button:"button",Command:"command",Conditional:"conditional",Event:"event",Hat:"hat",Loop:"loop",Reporter:"reporter"},a={Angle:"angle",Boolean:"Boolean",Color:"color",Number:"number",String:"string",Matrix:"matrix",Note:"note",Image:"image",Custom:"custom"},o={BackgroundLayer:"background",VideoLayer:"video",PenLayer:"pen",SpriteLayer:"sprite"},i=[o.VideoLayer,o.SpriteLayer,o.BackgroundLayer,o.PenLayer],s={"Аҧсшәа":"ab","العربية":"ar","አማርኛ":"am",Azeri:"az",Bahasa_Indonesia:"id","Беларуская":"be","Български":"bg","Català":"ca","Česky":"cs",Cymraeg:"cy",Dansk:"da",Deutsch:"de",Eesti:"et","Ελληνικά":"el",English:"en","Español":"es","Español_Latinoamericano":"es-419",Euskara:"eu","فارسی":"fa","Français":"fr",Gaeilge:"ga","Gàidhlig":"gd",Galego:"gl","한국어":"ko","עִבְרִית":"he",Hrvatski:"hr",isiZulu:"zu","Íslenska":"is",Italiano:"it","ქართული_ენა":"ka",Kiswahili:"sw","Kreyòl_ayisyen":"ht","کوردیی_ناوەندی":"ckb","Latviešu":"lv","Lietuvių":"lt",Magyar:"hu","Māori":"mi",Nederlands:"nl","日本語":"ja","にほんご":"ja-Hira","Norsk_Bokmål":"nb",Norsk_Nynorsk:"nn","Oʻzbekcha":"uz","ไทย":"th","ភាសាខ្មែរ":"km",Polski:"pl","Português":"pt","Português_Brasileiro":"pt-br",Rapa_Nui:"rap","Română":"ro","Русский":"ru","Српски":"sr","Slovenčina":"sk","Slovenščina":"sl",Suomi:"fi",Svenska:"sv","Tiếng_Việt":"vi","Türkçe":"tr","Українська":"uk","简体中文":"zh-cn","繁體中文":"zh-tw"},c=Object.keys(s);class l{static get RGB_BLACK(){return{r:0,g:0,b:0}}static get RGB_WHITE(){return{r:255,g:255,b:255}}static decimalToHex(t){t<0&&(t+=16777216);let e=Number(t).toString(16);return e=`#${"000000".substr(0,6-e.length)}${e}`,e}static decimalToRgb(t){const e=t>>24&255;return{r:t>>16&255,g:t>>8&255,b:255&t,a:e>0?e:255}}static hexToRgb(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,r,n)=>e+e+r+r+n+n));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}static rgbToHex(t){return l.decimalToHex(l.rgbToDecimal(t))}static rgbToDecimal(t){return(t.r<<16)+(t.g<<8)+t.b}static hexToDecimal(t){return l.rgbToDecimal(l.hexToRgb(t))}static hsvToRgb(t){let e=t.h%360;e<0&&(e+=360);const r=Math.max(0,Math.min(t.s,1)),n=Math.max(0,Math.min(t.v,1)),a=Math.floor(e/60),o=e/60-a,i=n*(1-r),s=n*(1-r*o),c=n*(1-r*(1-o));let l,u,p;switch(a){default:case 0:l=n,u=c,p=i;break;case 1:l=s,u=n,p=i;break;case 2:l=i,u=n,p=c;break;case 3:l=i,u=s,p=n;break;case 4:l=c,u=i,p=n;break;case 5:l=n,u=i,p=s}return{r:Math.floor(255*l),g:Math.floor(255*u),b:Math.floor(255*p)}}static rgbToHsv(t){const e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(Math.min(e,r),n),o=Math.max(Math.max(e,r),n);let i=0,s=0;if(a!==o){i=60*((e===a?3:r===a?5:1)-(e===a?r-n:r===a?n-e:e-r)/(o-a))%360,s=(o-a)/o}return{h:i,s:s,v:o}}static mixRgb(t,e,r){if(r<=0)return t;if(r>=1)return e;const n=1-r;return{r:n*t.r+r*e.r,g:n*t.g+r*e.g,b:n*t.b+r*e.b}}}const u=l;class p{static toNumber(t){if("number"==typeof t)return Number.isNaN(t)?0:t;const e=Number(t);return Number.isNaN(e)?0:e}static toBoolean(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t.toLowerCase():Boolean(t)}static toString(t){return String(t)}static toRgbColorList(t){const e=p.toRgbColorObject(t);return[e.r,e.g,e.b]}static toRgbColorObject(t){let e;return"string"==typeof t&&"#"===t.substring(0,1)?(e=u.hexToRgb(t),e||(e={r:0,g:0,b:0,a:255})):e=u.decimalToRgb(p.toNumber(t)),e}static isWhiteSpace(t){return null===t||"string"==typeof t&&0===t.trim().length}static compare(t,e){let r=Number(t),n=Number(e);if(0===r&&p.isWhiteSpace(t)?r=NaN:0===n&&p.isWhiteSpace(e)&&(n=NaN),isNaN(r)||isNaN(n)){const r=String(t).toLowerCase(),n=String(e).toLowerCase();return r<n?-1:r>n?1:0}return r===1/0&&n===1/0||r===-1/0&&n===-1/0?0:r-n}static isInt(t){return"number"==typeof t?!!isNaN(t)||t===parseInt(t,10):"boolean"==typeof t||"string"==typeof t&&t.indexOf(".")<0}static get LIST_INVALID(){return"INVALID"}static get LIST_ALL(){return"ALL"}static toListIndex(t,e,r){if("number"!=typeof t){if("all"===t)return r?p.LIST_ALL:p.LIST_INVALID;if("last"===t)return e>0?e:p.LIST_INVALID;if("random"===t||"any"===t)return e>0?1+Math.floor(Math.random()*e):p.LIST_INVALID}return(t=Math.floor(p.toNumber(t)))<1||t>e?p.LIST_INVALID:t}}var m=p;const d=(t,e)=>{switch(t){case a.String:return`${e}`;case a.Number:return parseFloat(e);case a.Boolean:return JSON.parse(e);case a.Note:case a.Angle:return parseInt(e);case a.Matrix:return h(e);case a.Color:return m.toRgbColorObject(e);default:throw new Error(`Method not implemented for value of ${e} and type ${t}`)}},g=t=>1===parseInt(t),h=t=>{if(25!==t.length)return new Array(5).fill(new Array(5).fill(!1));return t.split("").map(g).reduce(((t,e,r)=>{const n=Math.floor(r/5);return 0===r%5?t[n]=[e]:t[n].push(e),t}),new Array(5))},f="OPEN_UI_FROM_EXTENSION",y="REGISTER_BUTTON_CALLBACK_FROM_EXTENSION",E="internal_IsCustomArgument",b="isCustomArgumentHack",T="dropdownState",w="dropdownEntry",S="init",I="open",_="close",O=(t,e)=>t.emit(f,e),R=(t,e,r)=>{t.emit(y,e),t.on(e,r)};class A{constructor(t){this.root=t}get(...t){return`var(--${this.root}-${t.join("-")})`}primary(...t){return this.get("primary",...t)}secondary(...t){return this.get("secondary",...t)}tertiary(...t){return this.get("tertiary",...t)}transparent(...t){return this.get("transparent",...t)}light(...t){return this.get("light",...t)}}const N=new A("ui"),D=new A("text"),C=new A("motion"),k=new A("red"),x=new A("sound"),L=new A("control"),v=new A("data"),M=new A("pen"),P=new A("error"),B=new A("extensions"),$=new A("extensions"),F={ui:{primary:N.primary(),secondary:N.secondary(),tertiary:N.tertiary(),modalOverlay:N.get("modal","overlay"),white:N.get("white"),whiteDim:N.get("white","dim"),whiteTransparent:N.get("white","transparent"),transparent:N.transparent(),blackTransparent:N.get("black","transparent")},text:{primary:D.primary(),primaryTransparent:D.transparent()},motion:{primary:C.primary(),tertiary:C.tertiary(),transparent:C.get("transparent"),lightTansparent:C.light("transparent")},red:{primary:k.primary(),tertiary:k.tertiary()},sound:{primary:x.primary(),tertiary:x.tertiary()},control:{primary:L.primary()},data:{primary:v.primary()},pen:{primary:M.primary(),transparent:M.transparent()},error:{primary:P.primary(),light:P.light(),transparent:P.transparent()},extensions:{primary:B.primary(),tertiary:B.tertiary(),light:B.light(),transparent:B.transparent()},drop:{highlight:$.get("highlight")}};async function U(t,e=100){let r,n=t();for(;!n;)await new Promise((t=>{clearTimeout(r),r=setTimeout(t,e)})),n=t();return clearTimeout(r),n}const j=t=>"string"==typeof t||t instanceof String,G=t=>"[object Function]"===Object.prototype.toString.call(t)||"function"==typeof t||t instanceof Function,H=t=>t!==Object(t),V=t=>t,K=async t=>{const e=new Promise(((e,r)=>{const n=document.createElement("script");n.onload=e,n.onerror=r,n.async=!0,n.src=t,document.body.appendChild(n)}));await e},W=(t,e,...r)=>t.call(e,...r),z=t=>H(t)?t:t.type,J=t=>`internal_${t}`,q=(t,r,n)=>function(o,i){const s=n.map((({name:t,type:r,handler:n})=>{const i=o[t];if(r===a.Custom){return n(j(i)&&e.IsIdentifier(i)?this.customArgumentManager.getEntry(i).value:i)}return d(r,n(i))}));return r.call(t,...s,i)};const X=t=>{const e="args";return"arg"in t&&t.arg?[t.arg]:e in t&&(t[e]?.length??0)>0?t.args:[]},Z=(t,e)=>{const r=t.map(z),n=ut(t);return e??(e=r.map(((t,e)=>ot(e)))),Q(r,n,e),r.map(((t,r)=>({type:t,name:e[r],handler:n[r]})))},Q=(...t)=>{const{size:e}=t.reduce(((t,{length:e})=>t.add(e)),new Set);if(1!==e)throw new Error("Zip failed because collections weren't equal length")},Y=t=>G(t),tt=(t,e,r)=>t,et=t=>H(t)?`${t}`:{...t,value:`${t.value}`},rt=(t,e)=>`${t}_${e}`,nt=(t,e,r)=>{if(!r||0===r.length)return e;if(lt(e,r.length),!(t=>!j(t))(e))return tt(e);const n=e,a=r.map(((t,e)=>`[${ot(e)}]`));return tt(n(...a))},at=(t,e,r)=>{if(e&&0!==e.length)return Object.fromEntries(e.map(((e,n)=>{const a={};if(a.type=z(e),H(e))return a;const{defaultValue:o,options:i}=e;return st(a,t,n,o),ct(a,i,r),a})).reduce(((t,e,r)=>t.set(ot(r),e)),new Map))},ot=t=>`${t}`,it=t=>`${t}`,st=(t,e,r,n)=>{void 0!==n&&(t.defaultValue=((t,e,r)=>j(t)?tt(t):t)(n))},ct=(t,e,r)=>e?t.menu=((t,e)=>{const r=e.indexOf(t),n=r>=0?r:e.push(t)-1;return`${it(n)}`})(e,r):null,lt=(t,e)=>!0,ut=t=>t.map((t=>{if(H(t))return V;const{options:e}=t;return(t=>t&&"handler"in t)(e)?e.handler:V})),pt={isSimpleStatic:t=>Array.isArray(t),isSimpleDynamic:t=>G(t),isStaticWithReporters:t=>"items"in t,isDynamicWithReporters:t=>"getItems"in t},mt=(t,e)=>({acceptReporters:e,items:t.map((t=>t)).map(et)}),dt=async(t,e)=>{const r="blocklyDropDownContent",n=document.getElementsByClassName(r);if(1!==n.length)return console.error(`Uh oh! Expected 1 element with class '${r}', but found ${n.length}`);const[a]=n,o=await U((()=>a.children[0]));new t({target:a,anchor:o,props:e}),gt(o)},gt=t=>{[["goog-menuitem goog-option",t=>{t.margin="auto",t.paddingLeft=t.paddingRight="0px"}],["goog-menuitem-content",t=>t.textAlign="center"]].forEach((([e,r])=>{const n=t.getElementsByClassName(e);console.assert(1===n.length,`Incorrect number of elements found with class: ${e}`),r(n[0].style)}))},ht={DrowpdownOpen:I,DropdownClose:_,Init:S};class ft{internal_init(){this.init({runtime:this.runtime,videoFeed:this.runtime.ioDevices?.video})}constructor(t,e,r,n){this.runtime=t,this.name=e,this.id=r,this.blockIconURI=n}}const yt=t=>{return function(t){return class extends t{constructor(){super(...arguments),this.blockMap=new Map,this.menus=[]}pushBlock(t,e,r){if(this.blockMap.has(t))throw new Error(`Attempt to push block with opcode ${t}, but it was already set. This is assumed to be a mistake.`);this.blockMap.set(t,{definition:e,operation:r})}getInfo(){if(!this.info){const{id:t,name:e,blockIconURI:r}=this,n=Array.from(this.blockMap.entries()).map((t=>this.convertToInfo(t)));this.info={id:t,blocks:n,name:e,blockIconURI:r,menus:this.collectMenus()}}return this.info}convertToInfo(t){const[e,r]=t,{definition:a,operation:o}=r,i=Y(a)?W(a,this,this):a,{type:s,text:c}=i,l=X(i),{id:u,runtime:p,menus:m}=this,d={opcode:e,text:nt(e,c,l),blockType:s,arguments:at(e,l,m)};if(s===n.Button){const t=rt(u,e);R(p,t,o.bind(this)),d.func=t}else this[J(e)]=q(this,o,Z(l));return d}collectMenus(){const{isSimpleStatic:t,isSimpleDynamic:e,isStaticWithReporters:r,isDynamicWithReporters:n}=pt;return Object.fromEntries(this.menus.map(((a,o)=>{if(t(a))return mt(a,!1);if(e(a))return this.registerDynamicMenu(a,!1,o);if(r(a))return mt(a.items,!0);if(n(a))return this.registerDynamicMenu(a.getItems,!0,o);throw new Error("Unable to process menu")})).reduce(((t,e,r)=>t.set(it(r),e)),new Map))}registerDynamicMenu(t,e,r){const n=`internal_dynamic_${r}`;return this[n]=()=>t().map((t=>t)).map(et),{acceptReporters:e,items:n}}}}(function(t){return class extends t{constructor(){super(...arguments),this.saveDataHandler=void 0}save(t,e){const{saveDataHandler:n,id:a,argumentManager:o}=this,i=n?.hooks.onSave(this)??{};if(o?.saveTo(i),0===Object.keys(i).length)return;const s=t[r];s?s[a]=i:t[r]={[a]:i},e.add(a)}load(t){if(!t)return;const{saveDataHandler:n,id:a}=this,o=r in t?t[r][a]:null;o&&(n?.hooks.onLoad(this,o),(this.argumentManager??(this.argumentManager=new e)).loadFrom(o))}}}(function(t){return class extends t{constructor(){super(...arguments),this.makeCustomArgument=({component:t,initial:r,acceptReportersHandler:n})=>{this.argumentManager??(this.argumentManager=new e);const o=this.argumentManager.add(r),i=()=>[{text:E,value:JSON.stringify({component:t,id:o})}];return{type:a.Custom,defaultValue:o,options:void 0===n?i:{acceptsReports:!0,getItems:i,handler:n}}},this.argumentManager=null}get customArgumentManager(){return this.argumentManager}[b](t){if(1!==t.length)return!1;const e=t[0];if("object"!=typeof e)return!1;const{text:r}=e;return r===E}processCustomArgumentHack(t,[{value:e}],r){const{id:n,customArgumentManager:a}=this,{component:o,id:i}=JSON.parse(e);switch(t[T]){case ht.Init:return a.getCurrentEntries();case ht.DropdownClose:{const t=a.tryResolve();return t?[[t.entry.text,t.id]]:a.getCurrentEntries()}case ht.DrowpdownOpen:{const e=t[w],s=e?.value??i,c=a.getEntry(s),[l,u]=a.request();return dt(r(n,o),{setter:u,current:c,extension:this}),[["Apply",l]]}}throw new Error("Error during processing -- Context:"+ht)}}}((o=t,class extends o{openUI(t,e){const{id:r,name:n,runtime:a}=this;O(a,{id:r,name:n,component:t.replace(".svelte",""),label:e})}}))));var o},Et=new Map;class bt extends(yt(ft)){constructor(t){super(...arguments)}}const Tt=t=>`__block_${t}`;const wt=new RegExp("^[a-z0-9]+$","i"),St=new RegExp("[^a-z0-9]+","gi"),It=["prg","prg".split("").reverse().join("")],_t=new RegExp(`${It[0]}([0-9]+)${It[1]}`,"g"),Ot=(t,e,r)=>t.replaceAll(e,r),Rt=(t,e,r,n,a)=>{if(t.name=e,!r)return;t.options.name=r;const o=n[r];if(!o)return;const i=o.acceptReporters;if(i!==(t.options.acceptsReporters??!1))throw new Error(`The new options provided for the legacy block '${a}' for legacy argument '${e}' ${i?"should":"should NOT"} accept reporters`);const s=o.items;if(!s||0===s.length)return;const c=Array.isArray(t.options)?t.options:G(t.options)?t.options():t.options.items?t.options.items:t.options.getItems(),l=t=>H(t)?{text:`${t}`,value:t}:t,u=t=>JSON.stringify(t),p=s.map(l).map(u),m=c.map(l).map(u);for(const t of p)if(!m.includes(t))throw new Error(`Mismatch in old and new menus for block ${a}: arg ${e}. Old entry: ${t}, new entries: [${m.join(", ")}]`)};function At(t){return function(e,r){const n=e.name,a=J(n);return r.addInitializer((function(){this.pushBlock(n,t,e)})),function(){return this[a].call(this,...arguments)}}}const Nt="__registerMenuDetials";return t.ArgumentType=a,t.BlockType=n,t.Branch={Exit:0,Enter:1,First:1,Second:2,Third:3,Fourth:4,Fifth:5,Sixth:6,Seventh:7},t.CustomArgumentManager=e,t.DecoratedExtension=class extends bt{constructor(){super(...arguments),this.version="decorated"}},t.Extension=class extends bt{constructor(){super(...arguments),this.version="generic"}internal_init(){super.internal_init();const t=this.defineBlocks(),e=this;for(const r in t){const n=t[r],a=r in this?Tt(r):r,{operation:o,text:i,arg:s,args:c,type:l}=G(n)?n.call(this,this):n;this.pushBlock(a,{text:i,arg:s,args:c,type:l},o);const u=J(a);this[a]=function(){return e[u].call(e,...arguments)}}}},t.ExtensionBase=ft,t.ExtensionCommon=bt,t.FrameworkID="ExtensionFramework",t.Language=s,t.LanguageKeys=c,t.LayerGroups=i,t.RuntimeEvent={ScriptGlowOn:"SCRIPT_GLOW_ON",ScriptGlowOff:"SCRIPT_GLOW_OFF",BlockGlowOn:"BLOCK_GLOW_ON",BlockGlowOff:"BLOCK_GLOW_OFF",HasCloudDataUpdate:"HAS_CLOUD_DATA_UPDATE",TurboModeOn:"TURBO_MODE_ON",TurboModeOff:"TURBO_MODE_OFF",RecordingOn:"RECORDING_ON",RecordingOff:"RECORDING_OFF",ProjectStart:"PROJECT_START",ProjectRunStart:"PROJECT_RUN_START",ProjectRunStop:"PROJECT_RUN_STOP",ProjectStopAll:"PROJECT_STOP_ALL",StopForTarget:"STOP_FOR_TARGET",VisualReport:"VISUAL_REPORT",ProjectLoaded:"PROJECT_LOADED",ProjectChanged:"PROJECT_CHANGED",ToolboxExtensionsNeedUpdate:"TOOLBOX_EXTENSIONS_NEED_UPDATE",TargetsUpdate:"TARGETS_UPDATE",MonitorsUpdate:"MONITORS_UPDATE",BlockDragUpdate:"BLOCK_DRAG_UPDATE",BlockDragEnd:"BLOCK_DRAG_END",ExtensionAdded:"EXTENSION_ADDED",ExtensionFieldAdded:"EXTENSION_FIELD_ADDED",PeripheralListUpdate:"PERIPHERAL_LIST_UPDATE",PeripheralConnected:"PERIPHERAL_CONNECTED",PeripheralDisconnected:"PERIPHERAL_DISCONNECTED",PeripheralRequestError:"PERIPHERAL_REQUEST_ERROR",PeripheralConnectionLostError:"PERIPHERAL_CONNECTION_LOST_ERROR",PeripheralScanTimeout:"PERIPHERAL_SCAN_TIMEOUT",MicListening:"MIC_LISTENING",BlocksInfoUpdate:"BLOCKSINFO_UPDATE",RuntimeStarted:"RUNTIME_STARTED",RuntimeDisposed:"RUNTIME_DISPOSED",BlocksNeedUpdate:"BLOCKS_NEED_UPDATE"},t.SaveDataHandler=class{constructor(t){this.hooks=t}},t.ScratchBlocksConstants={OutputShapeHexagonal:1,OutputShapeRound:2,OutputShapeSquare:3},t.StageLayering=o,t.TargetType={Sprite:"sprite",Stage:"stage"},t.VariableType={Scalar:"",List:"list",BrooadcastMessage:"broadcast_msg"},t.activeClass=!0,t.block=At,t.buttonBlock=function(t){return At({text:t,type:n.Button})},t.castToType=d,t.closeDropdownState=_,t.color=F,t.copyTo=({target:t,source:e})=>{for(const r in e)r in t&&(t[r]=e[r])},t.customArgumentCheck=b,t.customArgumentFlag=E,t.decode=t=>[...[...t.matchAll(_t)].reduce(((t,e)=>{const[r,n]=e;return t.set(r,String.fromCharCode(n))}),new Map)].reduce(((t,[e,r])=>Ot(t,e,r)),`${t}`),t.dropdownEntryFlag=w,t.dropdownStateFlag=T,t.encode=t=>[...[...t.matchAll(St)].reduce(((t,e)=>(e[0].split("").forEach((e=>t.add(e))),t)),new Set)].map((t=>({char:t,code:t.charCodeAt(0)}))).reduce(((t,{char:e,code:r})=>Ot(t,e,`${It[0]}${r}${It[1]}`)),`${t}`),t.extension=function(t){return e=>{"undefined"==typeof window&&global?.[Nt]?.(t)}},t.extensionsMap=Et,t.extractLegacySupportFromOldGetInfo=t=>{const{blocks:e,menus:r}=t,n=e.filter((t=>!j(t))).map((t=>[t.opcode,e=>((t,e,r,n)=>{const a=e;if(e.name=t,"arg"in a){const[e,{menu:o}]=Object.entries(r.arguments)[0];Rt(a.arg,e,o,n,t)}else if("args"in a){const e=Object.entries(r.arguments);for(let r=0;r<e.length;r++){const[o,{menu:i}]=e[r];Rt(a.args[r],o,i,n,t)}}return e})(t.opcode,e,t,r)])).reduce(((t,[e,r])=>(t[e]=r,t)),{});return n.tsIgnore=n,n.legacyBlocksForTests=e.reduce(((t,e)=>(t[e.opcode]=e,t)),{}),n},t.fetchWithTimeout=async function(t,e){const{timeout:r}=e,n=new AbortController,a=setTimeout((()=>n.abort()),r),o=await fetch(t,{...e,signal:n.signal});return clearTimeout(a),o},t.getAlternativeOpcodeName=Tt,t.getTextFromMenuItem=t=>"object"==typeof t?t.text:t,t.getValueFromMenuItem=t=>"object"==typeof t?t.value:t,t.identity=V,t.initDropdownState=S,t.isFunction=G,t.isPrimitive=H,t.isString=j,t.isValidID=t=>wt.test(t),t.legacy=function(t){return function(e,r){class n extends(function(t,e){return class extends t{getInfo(){if(!this.validatedInfo){const{getInfo:t}=bt.prototype,e=t.call(this);this.validatedInfo=this.validateAndAttach(e)}return this.validatedInfo}validateAndAttach({id:t,blocks:r}){const{id:n,blocks:a}=e;if(t!==n)throw new Error("ID mismatch! IDs should match ");return e}}}(e,t)){constructor(){super(...arguments),this.originalClassName=r.name}}return n}},t.loadExternalScript=(t,e,r)=>{const n=document.createElement("script");n.onload=e,n.onerror=r??(()=>{throw new Error(`Error loading endpoint: ${t}`)}),n.src=t,n.async=!0,document.body.appendChild(n)},t.mockFormatMessage=t=>"",t.openDropdownState=I,t.openUI=O,t.openUIEvent=f,t.px=t=>`${t}px`,t.reactiveInvoke=(t,e,r)=>t[e](...r),t.reactiveSet=(t,e,r)=>{t[e]=r},t.registerButtonCallback=R,t.registerButtonCallbackEvent=y,t.registerExtensionDefinitionCallback=t=>global[Nt]=e=>{t(e),delete global[Nt]},t.renderToDropdown=dt,t.splitOnCapitals=t=>t.split(/(?=[A-Z])/),t.tryCastToArgumentType=(t,e,r)=>{try{return d(t,e)}catch{return r(e)}},t.typesafeCall=W,t.untilCondition=async function(t,e=100){let r;for(;!t();)await new Promise((t=>{clearTimeout(r),r=setTimeout(t,e)}));clearTimeout(r)},t.untilExternalGlobalVariableLoaded=async(t,e)=>(window[e]||await K(t),window[e]),t.untilExternalScriptLoaded=K,t.untilObject=U,t.untilReady=async function(t,e=100){let r;for(;!t.ready;)await new Promise((t=>{clearTimeout(r),r=setTimeout(t,e)}));clearTimeout(r)},Object.defineProperty(t,"__esModule",{value:!0}),t}({});//# sourceMappingURL=ExtensionFramework.js.map
