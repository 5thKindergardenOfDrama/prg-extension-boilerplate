var scratch3prg95grpjibo=function(e,t){"use strict";function n(){}function i(e){return e()}function s(){return Object.create(null)}function r(e){e.forEach(i)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let c,l;function u(e,t){return c||(c=document.createElement("a")),c.href=t,e===c.href}function h(e,t){e.appendChild(t)}function f(e,t,n){const i=function(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;if(t&&t.host)return t;return e.ownerDocument}(e);if(!i.getElementById(t)){const e=v("style");e.id=t,e.textContent=n,function(e,t){h(e.head||e,t),t.sheet}(i,e)}}function p(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode&&e.parentNode.removeChild(e)}function d(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function y(e){return document.createTextNode(e)}function g(){return y(" ")}function b(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function _(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e){l=e}const k=[],x=[];let T=[];const E=[],L=Promise.resolve();let j=!1;function A(e){T.push(e)}const S=new Set;let M=0;function C(){if(0!==M)return;const e=l;do{try{for(;M<k.length;){const e=k[M];M++,w(e),O(e.$$)}}catch(e){throw k.length=0,M=0,e}for(w(null),k.length=0,M=0;x.length;)x.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];S.has(t)||(S.add(t),t())}T.length=0}while(k.length);for(;E.length;)E.pop()();j=!1,S.clear(),w(e)}function O(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const R=new Set;function N(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];T.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),T=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function F(e,t){-1===e.$$.dirty[0]&&(k.push(e),j||(j=!0,L.then(C)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function z(e,t,a,c,u,h,f,p=[-1]){const d=l;w(e);const v=e.$$={fragment:null,ctx:[],props:h,update:n,not_equal:u,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(d?d.$$.context:[])),callbacks:s(),dirty:p,skip_bound:!1,root:t.target||d.$$.root};f&&f(v.root);let y=!1;if(v.ctx=a?a(e,t.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return v.ctx&&u(v.ctx[t],v.ctx[t]=s)&&(!v.skip_bound&&v.bound[t]&&v.bound[t](s),y&&F(e,t)),n})):[],v.update(),y=!0,r(v.before_update),v.fragment=!!c&&c(v.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);v.fragment&&v.fragment.l(e),e.forEach(m)}else v.fragment&&v.fragment.c();t.intro&&((g=e.$$.fragment)&&g.i&&(R.delete(g),g.i(b))),function(e,t,n,s){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,n),s||A((()=>{const t=e.$$.on_mount.map(i).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(A)}(e,t.target,t.anchor,t.customElement),C()}var g,b;w(d)}class P{$destroy(){N(this,1),this.$destroy=n}$on(e,t){if(!o(t))return n;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function D(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))}function I(){}function $(){$.init.call(this)}function J(e){return void 0===e._maxListeners?$.defaultMaxListeners:e._maxListeners}function U(e,t,n,i){var s,r,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((r=e._events)?(r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),o=r[t]):(r=e._events=new I,e._eventsCount=0),o){if("function"==typeof o?o=r[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),!o.warned&&(s=J(e))&&s>0&&o.length>s){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=r[t]=n,++e._eventsCount;return e}function G(e,t,n){var i=!1;function s(){e.removeListener(t,s),i||(i=!0,n.apply(e,arguments))}return s.listener=n,s}function B(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function q(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}I.prototype=Object.create(null),$.EventEmitter=$,$.usingDomains=!1,$.prototype.domain=void 0,$.prototype._events=void 0,$.prototype._maxListeners=void 0,$.defaultMaxListeners=10,$.init=function(){this.domain=null,$.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new I,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},$.prototype.getMaxListeners=function(){return J(this)},$.prototype.emit=function(e){var t,n,i,s,r,o,a,c="error"===e;if(o=this._events)c=c&&null==o.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,s=q(e,i),r=0;r<i;++r)s[r].call(n)}(n,u,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var s=e.length,r=q(e,s),o=0;o<s;++o)r[o].call(n,i)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,i,s){if(t)e.call(n,i,s);else for(var r=e.length,o=q(e,r),a=0;a<r;++a)o[a].call(n,i,s)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,s,r){if(t)e.call(n,i,s,r);else for(var o=e.length,a=q(e,o),c=0;c<o;++c)a[c].call(n,i,s,r)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(i-1),r=1;r<i;r++)s[r-1]=arguments[r];!function(e,t,n,i){if(t)e.apply(n,i);else for(var s=e.length,r=q(e,s),o=0;o<s;++o)r[o].apply(n,i)}(n,u,this,s)}return!0},$.prototype.addListener=function(e,t){return U(this,e,t,!1)},$.prototype.on=$.prototype.addListener,$.prototype.prependListener=function(e,t){return U(this,e,t,!0)},$.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,G(this,e,t)),this},$.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,G(this,e,t)),this},$.prototype.removeListener=function(e,t){var n,i,s,r,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new I:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length;r-- >0;)if(n[r]===t||n[r].listener&&n[r].listener===t){o=n[r].listener,s=r;break}if(s<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new I,this;delete i[e]}else!function(e,t){for(var n=t,i=n+1,s=e.length;i<s;n+=1,i+=1)e[n]=e[i];e.pop()}(n,s);i.removeListener&&this.emit("removeListener",e,o||t)}return this},$.prototype.off=function(e,t){return this.removeListener(e,t)},$.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new I,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new I:delete n[e]),this;if(0===arguments.length){for(var i,s=Object.keys(n),r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new I,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},$.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},$.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):B.call(e,t)},$.prototype.listenerCount=B,$.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var H="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},V=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Q,X,K,Z,ee,te,ne=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,i,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),r=1;r<arguments.length;r++){for(var o in n=Object(arguments[r]))W.call(n,o)&&(s[o]=n[o]);if(V){i=V(n);for(var a=0;a<i.length;a++)Y.call(n,i[a])&&(s[i[a]]=n[i[a]])}}return s},ie={},se={get exports(){return ie},set exports(e){ie=e}};function re(){return X?Q:(X=1,Q=function(e,t,n){t.forEach((function(t){var i=n[t];e.prototype[t]=function(e){return e.ros=this,new i(e)}}))})}function oe(){return Z?K:(Z=1,K="undefined"!=typeof window?window.WebSocket:WebSocket)}var ae,ce,le,ue,he,fe,pe,me,de,ve={},ye={get exports(){return ve},set exports(e){ve=e}};function ge(){return ae||(ae=1,function(e){function t(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var i=n(n.s=ENTRY_MODULE);return i.default||i}var n="[\\.|\\-|\\+|\\w|/|@]+",i="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+n+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function r(e,t,r){var o={};o[r]=[];var a=t.toString(),c=a.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return o;for(var l,u=c[1],h=new RegExp("(\\\\n|\\W)"+s(u)+i,"g");l=h.exec(a);)"dll-reference"!==l[3]&&o[r].push(l[3]);for(h=new RegExp("\\("+s(u)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+i,"g");l=h.exec(a);)e[l[2]]||(o[r].push(l[1]),e[l[2]]=__webpack_require__(l[1]).m),o[l[2]]=o[l[2]]||[],o[l[2]].push(l[4]);for(var f,p=Object.keys(o),m=0;m<p.length;m++)for(var d=0;d<o[p[m]].length;d++)f=o[p[m]][d],isNaN(1*f)||(o[p[m]][d]=1*o[p[m]][d]);return o}function o(e){return Object.keys(e).reduce((function(t,n){return t||e[n].length>0}),!1)}e.exports=function(e,n){n=n||{};var i={main:__webpack_modules__},s=n.all?{main:Object.keys(i.main)}:function(e,t){for(var n={main:[t]},i={main:[]},s={main:{}};o(n);)for(var a=Object.keys(n),c=0;c<a.length;c++){var l=a[c],u=n[l].pop();if(s[l]=s[l]||{},!s[l][u]&&e[l][u]){s[l][u]=!0,i[l]=i[l]||[],i[l].push(u);for(var h=r(e,e[l][u],l),f=Object.keys(h),p=0;p<f.length;p++)n[f[p]]=n[f[p]]||[],n[f[p]]=n[f[p]].concat(h[f[p]])}}return i}(i,e),a="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var n=0;s[e][n];)n++;s[e].push(n),i[e][n]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+e+" = ("+t.toString().replace("ENTRY_MODULE",JSON.stringify(n))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),a=a+"new (("+t.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var c=new window.Blob([a],{type:"text/javascript"});if(n.bare)return c;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),u=new window.Worker(l);return u.objectURL=l,u}}(ye)),ve}function be(){if(le)return ce;le=1;var e=e||oe();return ce=function(t){var n=null;function i(e){var n=e.data;n instanceof ArrayBuffer?t.postMessage(n,[n]):t.postMessage(n)}function s(e){t.postMessage({type:e.type})}t.addEventListener("message",(function(t){var r=t.data;if("string"==typeof r)n.send(r);else if(r.hasOwnProperty("close"))n.close(),n=null;else{if(!r.hasOwnProperty("uri"))throw"Unknown message to WorkerSocket";var o=r.uri;(n=new e(o)).binaryType="arraybuffer",n.onmessage=i,n.onclose=s,n.onopen=s,n.onerror=s}}))}}function _e(){if(he)return ue;he=1;try{var e=function(){if(te)return ee;te=1;var e=arguments[3],t=arguments[4],n=arguments[5],i=JSON.stringify;return ee=function(s,r){for(var o,a=Object.keys(n),c=0,l=a.length;c<l;c++){var u=a[c],h=n[u].exports;if(h===s||h&&h.default===s){o=u;break}}if(!o){o=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var f={};for(c=0,l=a.length;c<l;c++)f[u=a[c]]=u;t[o]=["function(require,module,exports){"+s+"(self); }",f]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),m={};m[o]=o,t[p]=["function(require,module,exports){var f = require("+i(o)+");(f.default ? f.default : f)(self);}",m];var d={};!function e(n){for(var i in d[n]=!0,t[n][1]){var s=t[n][1][i];d[s]||e(s)}}(p);var v="("+e+")({"+Object.keys(d).map((function(e){return i(e)+":["+t[e][0]+","+i(t[e][1])+"]"})).join(",")+"},{},["+i(p)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,g=new Blob([v],{type:"text/javascript"});if(r&&r.bare)return g;var b=y.createObjectURL(g),_=new Worker(b);return _.objectURL=b,_}}()}catch(t){e=ge()}var t=be();function n(n){this.socket_=e(t),this.socket_.addEventListener("message",this.handleWorkerMessage_.bind(this)),this.socket_.postMessage({uri:n})}return n.prototype.handleWorkerMessage_=function(e){var t=e.data;if(t instanceof ArrayBuffer||"string"==typeof t)this.onmessage(e);else{var n=t.type;if("close"===n)this.onclose(null);else if("open"===n)this.onopen(null);else{if("error"!==n)throw"Unknown message from workersocket";this.onerror(null)}}},n.prototype.send=function(e){this.socket_.postMessage(e)},n.prototype.close=function(){this.socket_.postMessage({close:!0})},ue=n}function we(){if(de)return me;de=1;var e=pe?fe:(pe=1,fe=function(){return document.createElement("canvas")}),t=e.Image||window.Image;return me=function(n,i){var s=new t;s.onload=function(){var t=new e,n=t.getContext("2d");t.width=s.width,t.height=s.height,n.imageSmoothingEnabled=!1,n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.drawImage(s,0,0);for(var r=n.getImageData(0,0,s.width,s.height).data,o="",a=0;a<r.length;a+=4)o+=String.fromCharCode(r[a],r[a+1],r[a+2]);i(JSON.parse(o))},s.src="data:image/png;base64,"+n},me}var ke,xe={},Te={get exports(){return xe},set exports(e){xe=e}};function Ee(){return ke||(ke=1,e=Te,function(t,n){var i=Math.pow(2,-24),s=Math.pow(2,32),r=Math.pow(2,53),o={encode:function(e){var t,i=new ArrayBuffer(256),o=new DataView(i),a=0;function c(e){for(var n=i.byteLength,s=a+e;n<s;)n*=2;if(n!==i.byteLength){var r=o;i=new ArrayBuffer(n),o=new DataView(i);for(var c=a+3>>2,l=0;l<c;++l)o.setUint32(4*l,r.getUint32(4*l))}return t=e,o}function l(){a+=t}function u(e){l(c(1).setUint8(a,e))}function h(e){for(var t=c(e.length),n=0;n<e.length;++n)t.setUint8(a+n,e[n]);l()}function f(e,t){t<24?u(e<<5|t):t<256?(u(e<<5|24),u(t)):t<65536?(u(e<<5|25),function(e){l(c(2).setUint16(a,e))}(t)):t<4294967296?(u(e<<5|26),function(e){l(c(4).setUint32(a,e))}(t)):(u(e<<5|27),function(e){var t=e%s,n=(e-t)/s,i=c(8);i.setUint32(a,n),i.setUint32(a+4,t),l()}(t))}if(function e(t){var i;if(!1===t)return u(244);if(!0===t)return u(245);if(null===t)return u(246);if(t===n)return u(247);switch(typeof t){case"number":if(Math.floor(t)===t){if(0<=t&&t<=r)return f(0,t);if(-r<=t&&t<0)return f(1,-(t+1))}return u(251),function(e){l(c(8).setFloat64(a,e))}(t);case"string":var s=[];for(i=0;i<t.length;++i){var o=t.charCodeAt(i);o<128?s.push(o):o<2048?(s.push(192|o>>6),s.push(128|63&o)):o<55296?(s.push(224|o>>12),s.push(128|o>>6&63),s.push(128|63&o)):(o=(1023&o)<<10,o|=1023&t.charCodeAt(++i),o+=65536,s.push(240|o>>18),s.push(128|o>>12&63),s.push(128|o>>6&63),s.push(128|63&o))}return f(3,s.length),h(s);default:var p;if(Array.isArray(t))for(f(4,p=t.length),i=0;i<p;++i)e(t[i]);else if(t instanceof Uint8Array)f(2,t.length),h(t);else{var m=Object.keys(t);for(f(5,p=m.length),i=0;i<p;++i){var d=m[i];e(d),e(t[d])}}}}(e),"slice"in i)return i.slice(0,a);for(var p=new ArrayBuffer(a),m=new DataView(p),d=0;d<a;++d)m.setUint8(d,o.getUint8(d));return p},decode:function(e,t,r){var o=new DataView(e),a=0;function c(e,t){return a+=t,e}function l(t){return c(new Uint8Array(e,a,t),t)}function u(){return c(o.getUint8(a),1)}function h(){return c(o.getUint16(a),2)}function f(){return c(o.getUint32(a),4)}function p(){return 255===o.getUint8(a)&&(a+=1,!0)}function m(e){if(e<24)return e;if(24===e)return u();if(25===e)return h();if(26===e)return f();if(27===e)return f()*s+f();if(31===e)return-1;throw"Invalid length encoding"}function d(e){var t=u();if(255===t)return-1;var n=m(31&t);if(n<0||t>>5!==e)throw"Invalid indefinite length element";return n}function v(e,t){for(var n=0;n<t;++n){var i=u();128&i&&(i<224?(i=(31&i)<<6|63&u(),t-=1):i<240?(i=(15&i)<<12|(63&u())<<6|63&u(),t-=2):(i=(15&i)<<18|(63&u())<<12|(63&u())<<6|63&u(),t-=3)),i<65536?e.push(i):(i-=65536,e.push(55296|i>>10),e.push(56320|1023&i))}}"function"!=typeof t&&(t=function(e){return e}),"function"!=typeof r&&(r=function(){return n});var y=function e(){var s,f,y=u(),g=y>>5,b=31&y;if(7===g)switch(b){case 25:return function(){var e=new ArrayBuffer(4),t=new DataView(e),n=h(),s=32768&n,r=31744&n,o=1023&n;if(31744===r)r=261120;else if(0!==r)r+=114688;else if(0!==o)return o*i;return t.setUint32(0,s<<16|r<<13|o<<13),t.getFloat32(0)}();case 26:return c(o.getFloat32(a),4);case 27:return c(o.getFloat64(a),8)}if((f=m(b))<0&&(g<2||6<g))throw"Invalid length";switch(g){case 0:return f;case 1:return-1-f;case 2:if(f<0){for(var _=[],w=0;(f=d(g))>=0;)w+=f,_.push(l(f));var k=new Uint8Array(w),x=0;for(s=0;s<_.length;++s)k.set(_[s],x),x+=_[s].length;return k}return l(f);case 3:var T=[];if(f<0)for(;(f=d(g))>=0;)v(T,f);else v(T,f);return String.fromCharCode.apply(null,T);case 4:var E;if(f<0)for(E=[];!p();)E.push(e());else for(E=new Array(f),s=0;s<f;++s)E[s]=e();return E;case 5:var L={};for(s=0;s<f||f<0&&!p();++s)L[e()]=e();return L;case 6:return t(e(),f);case 7:switch(f){case 20:return!1;case 21:return!0;case 22:return null;case 23:return n;default:return r(f)}}}();if(a!==e.byteLength)throw"Remaining bytes";return y}};"function"==typeof n&&n.amd?n("cbor/cbor",o):e.exports?e.exports=o:t.CBOR||(t.CBOR=o)}(H)),xe;var e}var Le,je,Ae,Se,Me,Ce,Oe,Re={},Ne={get exports(){return Re},set exports(e){Re=e}};function Fe(){if(Ae)return je;Ae=1;var e=we(),t=Ee(),n=(Le||(Le=1,function(e){var t=Math.pow(2,32),n=!1;function i(){n||(n=!0,console.warn("CBOR 64-bit integer array values may lose precision. No further warnings."))}var s={64:Uint8Array,69:Uint16Array,70:Uint32Array,72:Int8Array,77:Int16Array,78:Int32Array,85:Float32Array,86:Float64Array},r={71:function(e){i();for(var n=e.byteLength,s=e.byteOffset,r=n/8,o=e.buffer.slice(s,s+n),a=new Uint32Array(o),c=new Array(r),l=0;l<r;l++){var u=2*l,h=a[u],f=a[u+1];c[l]=h+t*f}return c},79:function(e){i();for(var n=e.byteLength,s=e.byteOffset,r=n/8,o=e.buffer.slice(s,s+n),a=new Uint32Array(o),c=new Int32Array(o),l=new Array(r),u=0;u<r;u++){var h=2*u,f=a[h],p=c[h+1];l[u]=f+t*p}return l}};e.exports&&(e.exports=function(e,t){var n,i,o,a;return t in s?(i=s[t],o=(n=e).byteLength,a=n.byteOffset,new i(n.buffer.slice(a,a+o))):t in r?r[t](e):e})}(Ne)),Re),i=null;return"undefined"!=typeof bson&&(i=bson().BSON),je=function(s){var r=null;function o(e){"publish"===e.op?s.emit(e.topic,e.msg):"service_response"===e.op?s.emit(e.id,e):"call_service"===e.op?s.emit(e.service,e):"status"===e.op&&(e.id?s.emit("status:"+e.id,e):s.emit("status",e))}function a(t,n){"png"===t.op?e(t.data,n):n(t)}return s.transportOptions.decoder&&(r=s.transportOptions.decoder),{onopen:function(e){s.isConnected=!0,s.emit("connection",e)},onclose:function(e){s.isConnected=!1,s.emit("close",e)},onerror:function(e){s.emit("error",e)},onmessage:function(e){if(r)r(e.data,(function(e){o(e)}));else if("undefined"!=typeof Blob&&e.data instanceof Blob)!function(e,t){if(!i)throw"Cannot process BSON encoded message without BSON header.";var n=new FileReader;n.onload=function(){var e=new Uint8Array(this.result),n=i.deserialize(e);t(n)},n.readAsArrayBuffer(e)}(e.data,(function(e){a(e,o)}));else if(e.data instanceof ArrayBuffer){o(t.decode(e.data,n))}else{a(JSON.parse("string"==typeof e?e:e.data),o)}}}}}function ze(){if(Me)return Se;Me=1;var e=ne;return Se=function(t){e(this,t)}}function Pe(){if(Oe)return Ce;Oe=1;var e=ne;return Ce=function(t){e(this,t)}}var De,Ie,$e,Je,Ue,Ge,Be,qe,He,Ve,We,Ye,Qe={},Xe={get exports(){return Qe},set exports(e){Qe=e}};function Ke(){return De||(De=1,e=Xe,function(t){var n=Object.hasOwnProperty,i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s="object"==typeof process&&"function"==typeof process.nextTick,r="function"==typeof Symbol,o="object"==typeof Reflect,a="function"==typeof setImmediate?setImmediate:setTimeout,c=r?o&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function l(){this._events={},this._conf&&u.call(this,this._conf)}function u(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==t&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function h(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=e,process.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var f=function(e,t,n){var i=arguments.length;switch(i){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var s=new Array(i);i--;)s[i]=arguments[i];return s}};function p(e,n){for(var i={},s=e.length,r=n?n.length:0,o=0;o<s;o++)i[e[o]]=o<r?n[o]:t;return i}function m(e,t,n){var i,s;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(i=n.on,s=n.off),t.addEventListener?(i=t.addEventListener,s=t.removeEventListener):t.addListener?(i=t.addListener,s=t.removeListener):t.on&&(i=t.on,s=t.off),!i&&!s)throw Error("target does not implement any known event API");if("function"!=typeof i)throw TypeError("on method must be a function");if("function"!=typeof s)throw TypeError("off method must be a function");this._on=i,this._off=s;var r=e._observers;r?r.push(this):e._observers=[this]}function d(e,i,s,r){var o=Object.assign({},i);if(!e)return o;if("object"!=typeof e)throw TypeError("options must be an object");var a,c,l,u=Object.keys(e),h=u.length;function f(e){throw Error('Invalid "'+a+'" option value'+(e?". Reason: "+e:""))}for(var p=0;p<h;p++){if(a=u[p],!r&&!n.call(i,a))throw Error('Unknown "'+a+'" option');(c=e[a])!==t&&(l=s[a],o[a]=l?l(c,f):c)}return o}function v(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function y(e){var t="value must be type of "+e.join("|"),n=e.length,i=e[0],s=e[1];return 1===n?function(e,n){if(typeof e===i)return e;n(t)}:2===n?function(e,n){var r=typeof e;if(r===i||r===s)return e;n(t)}:function(i,s){for(var r=typeof i,o=n;o-- >0;)if(r===e[o])return i;s(t)}}Object.assign(m.prototype,{subscribe:function(e,t,n){var i=this,s=this._target,r=this._emitter,o=this._listeners,a=function(){var i=f.apply(null,arguments),o={data:i,name:t,original:e};n?!1!==n.call(s,o)&&r.emit.apply(r,[o.name].concat(i)):r.emit.apply(r,[t].concat(i))};if(o[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,r._newListener&&r._removeListener&&!i._onNewListener?(this._onNewListener=function(n){n===t&&null===o[e]&&(o[e]=a,i._on.call(s,e,a))},r.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!r.hasListeners(n)&&o[e]&&(o[e]=null,i._off.call(s,e,a))},o[e]=null,r.on("removeListener",this._onRemoveListener)):(o[e]=a,i._on.call(s,e,a))},unsubscribe:function(e){var t,n,i,s=this,r=this._listeners,o=this._emitter,a=this._off,l=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function u(){s._onNewListener&&(o.off("newListener",s._onNewListener),o.off("removeListener",s._onRemoveListener),s._onNewListener=null,s._onRemoveListener=null);var e=w.call(o,s);o._observers.splice(e,1)}if(e){if(!(t=r[e]))return;a.call(l,e,t),delete r[e],--this._listenersCount||u()}else{for(i=(n=c(r)).length;i-- >0;)e=n[i],a.call(l,e,r[e]);this._listeners={},this._listenersCount=0,u()}}});var g=y(["function"]),b=y(["object","function"]);function _(e,t,n){var i,s,r,o=0,a=new e((function(c,l,u){function h(){s&&(s=null),o&&(clearTimeout(o),o=0)}n=d(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),i=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var f=function(e){h(),c(e)},p=function(e){h(),l(e)};i?t(f,p,u):(s=[function(e){p(e||Error("canceled"))}],t(f,p,(function(e){if(r)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");s.push(e)})),r=!0),n.timeout>0&&(o=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",o=0,a.cancel(e),l(e)}),n.timeout))}));return i||(a.cancel=function(e){if(s){for(var t=s.length,n=1;n<t;n++)s[n](e);s[0](e),s=null}}),a}function w(e){var t=this._observers;if(!t)return-1;for(var n=t.length,i=0;i<n;i++)if(t[i]._target===e)return i;return-1}function k(e,t,n,i,s){if(!n)return null;if(0===i){var r=typeof t;if("string"===r){var o,a,l=0,u=0,h=this.delimiter,f=h.length;if(-1!==(a=t.indexOf(h))){o=new Array(5);do{o[l++]=t.slice(u,a),u=a+f}while(-1!==(a=t.indexOf(h,u)));o[l++]=t.slice(u),t=o,s=l}else t=[t],s=1}else"object"===r?s=t.length:(t=[t],s=1)}var p,m,d,v,y,g,b,_=null,w=t[i],x=t[i+1];if(i===s)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),_=[n]):(e&&e.push.apply(e,n._listeners),_=[n]));else{if("*"===w){for(a=(g=c(n)).length;a-- >0;)"_listeners"!==(p=g[a])&&(b=k(e,t,n[p],i+1,s))&&(_?_.push.apply(_,b):_=b);return _}if("**"===w){for((y=i+1===s||i+2===s&&"*"===x)&&n._listeners&&(_=k(e,t,n,s,s)),a=(g=c(n)).length;a-- >0;)"_listeners"!==(p=g[a])&&("*"===p||"**"===p?(n[p]._listeners&&!y&&(b=k(e,t,n[p],s,s))&&(_?_.push.apply(_,b):_=b),b=k(e,t,n[p],i,s)):b=k(e,t,n[p],p===x?i+2:i,s),b&&(_?_.push.apply(_,b):_=b));return _}n[w]&&(_=k(e,t,n[w],i+1,s))}if((m=n["*"])&&k(e,t,m,i+1,s),d=n["**"])if(i<s)for(d._listeners&&k(e,t,d,s,s),a=(g=c(d)).length;a-- >0;)"_listeners"!==(p=g[a])&&(p===x?k(e,t,d[p],i+2,s):p===w?k(e,t,d[p],i+1,s):((v={})[p]=d[p],k(e,t,{"**":v},i+1,s)));else d._listeners?k(e,t,d,s,s):d["*"]&&d["*"]._listeners&&k(e,t,d["*"],s,s);return _}function x(e,t,n){var i,s,r=0,o=0,a=this.delimiter,c=a.length;if("string"==typeof e)if(-1!==(i=e.indexOf(a))){s=new Array(5);do{s[r++]=e.slice(o,i),o=i+c}while(-1!==(i=e.indexOf(a,o)));s[r++]=e.slice(o)}else s=[e],r=1;else s=e,r=e.length;if(r>1)for(i=0;i+1<r;i++)if("**"===s[i]&&"**"===s[i+1])return;var l,u=this.listenerTree;for(i=0;i<r;i++)if(u=u[l=s[i]]||(u[l]={}),i===r-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,h.call(this,u._listeners.length,l))):u._listeners=t,!0;return!0}function T(e,t,n,i){for(var s,r,o,a,l=c(e),u=l.length,h=e._listeners;u-- >0;)s=e[r=l[u]],o="_listeners"===r?n:n?n.concat(r):[r],a=i||"symbol"==typeof r,h&&t.push(a?o:o.join(this.delimiter)),"object"==typeof s&&T.call(this,s,t,o,a);return t}function E(e){for(var t,n,i,s=c(e),r=s.length;r-- >0;)(t=e[n=s[r]])&&(i=!0,"_listeners"===n||E(t)||delete e[n]);return i}function L(e,t,n){this.emitter=e,this.event=t,this.listener=n}function j(e,n,i){if(!0===i)o=!0;else if(!1===i)r=!0;else{if(!i||"object"!=typeof i)throw TypeError("options should be an object or true");var r=i.async,o=i.promisify,c=i.nextTick,l=i.objectify}if(r||c||o){var u=n,h=n._origin||n;if(c&&!s)throw Error("process.nextTick is not supported");o===t&&(o="AsyncFunction"===n.constructor.name),n=function(){var e=arguments,t=this,n=this.event;return o?c?Promise.resolve():new Promise((function(e){a(e)})).then((function(){return t.event=n,u.apply(t,e)})):(c?process.nextTick:a)((function(){t.event=n,u.apply(t,e)}))},n._async=!0,n._origin=h}return[n,l?new L(this,e,n):this]}function A(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,u.call(this,e)}L.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},A.EventEmitter2=A,A.prototype.listenTo=function(e,n,s){if("object"!=typeof e)throw TypeError("target musts be an object");var r=this;function o(t){if("object"!=typeof t)throw TypeError("events must be an object");var n,i=s.reducers,o=w.call(r,e);n=-1===o?new m(r,e,s):r._observers[o];for(var a,l=c(t),u=l.length,h="function"==typeof i,f=0;f<u;f++)a=l[f],n.subscribe(a,t[a]||a,h?i:i&&i[a])}return s=d(s,{on:t,off:t,reducers:t},{on:g,off:g,reducers:b}),i(n)?o(p(n)):o("string"==typeof n?p(n.split(/\s+/)):n),this},A.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var i,s=n.length,r=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;s-- >0;)i=n[s],e&&i._target!==e||(i.unsubscribe(t),r=!0);return r},A.prototype.delimiter=".",A.prototype.setMaxListeners=function(e){e!==t&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},A.prototype.getMaxListeners=function(){return this._maxListeners},A.prototype.event="",A.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},A.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},A.prototype._once=function(e,t,n,i){return this._many(e,1,t,n,i)},A.prototype.many=function(e,t,n,i){return this._many(e,t,n,!1,i)},A.prototype.prependMany=function(e,t,n,i){return this._many(e,t,n,!0,i)},A.prototype._many=function(e,t,n,i,s){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function o(){return 0==--t&&r.off(e,o),n.apply(this,arguments)}return o._origin=n,this._on(e,o,i,s)},A.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||l.call(this);var e,t,n,i,s,o,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,r)for(i=0;i<n;i++)if("symbol"==typeof a[i]){o=!0;break}o||(a=a.join(this.delimiter))}var u,h=arguments.length;if(this._all&&this._all.length)for(i=0,n=(u=this._all.slice()).length;i<n;i++)switch(this.event=a,h){case 1:u[i].call(this,a);break;case 2:u[i].call(this,a,arguments[1]);break;case 3:u[i].call(this,a,arguments[1],arguments[2]);break;default:u[i].apply(this,arguments)}if(c)u=[],k.call(this,u,e,this.listenerTree,0,n);else{if("function"==typeof(u=this._events[a])){switch(this.event=a,h){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(h-1),s=1;s<h;s++)t[s-1]=arguments[s];u.apply(this,t)}return!0}u&&(u=u.slice())}if(u&&u.length){if(h>3)for(t=new Array(h-1),s=1;s<h;s++)t[s-1]=arguments[s];for(i=0,n=u.length;i<n;i++)switch(this.event=a,h){case 1:u[i].call(this);break;case 2:u[i].call(this,arguments[1]);break;case 3:u[i].call(this,arguments[1],arguments[2]);break;default:u[i].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},A.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||l.call(this);var e,t,n,i,s,o,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(i=a.length,r)for(s=0;s<i;s++)if("symbol"==typeof a[s]){t=!0;break}t||(a=a.join(this.delimiter))}var u,h=[],f=arguments.length;if(this._all)for(s=0,i=this._all.length;s<i;s++)switch(this.event=a,f){case 1:h.push(this._all[s].call(this,a));break;case 2:h.push(this._all[s].call(this,a,arguments[1]));break;case 3:h.push(this._all[s].call(this,a,arguments[1],arguments[2]));break;default:h.push(this._all[s].apply(this,arguments))}if(c?(u=[],k.call(this,u,e,this.listenerTree,0)):u=this._events[a],"function"==typeof u)switch(this.event=a,f){case 1:h.push(u.call(this));break;case 2:h.push(u.call(this,arguments[1]));break;case 3:h.push(u.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];h.push(u.apply(this,n))}else if(u&&u.length){if(u=u.slice(),f>3)for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];for(s=0,i=u.length;s<i;s++)switch(this.event=a,f){case 1:h.push(u[s].call(this));break;case 2:h.push(u[s].call(this,arguments[1]));break;case 3:h.push(u[s].call(this,arguments[1],arguments[2]));break;default:h.push(u[s].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(h)},A.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},A.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},A.prototype.onAny=function(e){return this._onAny(e,!1)},A.prototype.prependAny=function(e){return this._onAny(e,!0)},A.prototype.addListener=A.prototype.on,A.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},A.prototype._on=function(e,n,i,s){if("function"==typeof e)return this._onAny(e,n),this;if("function"!=typeof n)throw new Error("on only accepts instances of Function");this._events||l.call(this);var r,o=this;return s!==t&&(n=(r=j.call(this,e,n,s))[0],o=r[1]),this._newListener&&this.emit("newListener",e,n),this.wildcard?(x.call(this,e,n,i),o):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),i?this._events[e].unshift(n):this._events[e].push(n),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,h.call(this,this._events[e].length,e))):this._events[e]=n,o)},A.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,s=[];if(this.wildcard){var r="string"==typeof e?e.split(this.delimiter):e.slice();if(!(s=k.call(this,null,r,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],s.push({_listeners:n})}for(var o=0;o<s.length;o++){var a=s[o];if(n=a._listeners,i(n)){for(var c=-1,l=0,u=n.length;l<u;l++)if(n[l]===t||n[l].listener&&n[l].listener===t||n[l]._origin&&n[l]._origin===t){c=l;break}if(c<0)continue;return this.wildcard?a._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&E(this.listenerTree),this},A.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(n=0,i=(t=this._all).length;n<i;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,i=t.length;n<i;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},A.prototype.removeListener=A.prototype.off,A.prototype.removeAllListeners=function(e){if(e===t)return!this._events||l.call(this),this;if(this.wildcard){var n,i=k.call(this,null,e,this.listenerTree,0);if(!i)return this;for(n=0;n<i.length;n++)i[n]._listeners=null;this.listenerTree&&E(this.listenerTree)}else this._events&&(this._events[e]=null);return this},A.prototype.listeners=function(e){var n,i,s,r,o,a=this._events;if(e===t){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(r=(n=c(a)).length,s=[];r-- >0;)"function"==typeof(i=a[n[r]])?s.push(i):s.push.apply(s,i);return s}if(this.wildcard){if(!(o=this.listenerTree))return[];var l=[],u="string"==typeof e?e.split(this.delimiter):e.slice();return k.call(this,l,u,o,0),l}return a&&(i=a[e])?"function"==typeof i?[i]:i:[]},A.prototype.eventNames=function(e){var t=this._events;return this.wildcard?T.call(this,this.listenerTree,[],null,e):t?c(t):[]},A.prototype.listenerCount=function(e){return this.listeners(e).length},A.prototype.hasListeners=function(e){if(this.wildcard){var n=[],i="string"==typeof e?e.split(this.delimiter):e.slice();return k.call(this,n,i,this.listenerTree,0),n.length>0}var s=this._events,r=this._all;return!!(r&&r.length||s&&(e===t?c(s).length:s[e]))},A.prototype.listenersAny=function(){return this._all?this._all:[]},A.prototype.waitFor=function(e,n){var i=this,s=typeof n;return"number"===s?n={timeout:n}:"function"===s&&(n={filter:n}),_((n=d(n,{timeout:0,filter:t,handleError:!1,Promise:Promise,overload:!1},{filter:g,Promise:v})).Promise,(function(t,s,r){function o(){var r=n.filter;if(!r||r.apply(i,arguments))if(i.off(e,o),n.handleError){var a=arguments[0];a?s(a):t(f.apply(null,arguments).slice(1))}else t(f.apply(null,arguments))}r((function(){i.off(e,o)})),i._on(e,o,!1)}),{timeout:n.timeout,overload:n.overload})};var S=A.prototype;Object.defineProperties(A,{defaultMaxListeners:{get:function(){return S._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");S._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return _((n=d(n,{Promise:Promise,timeout:0,overload:!1},{Promise:v})).Promise,(function(n,i,s){var r;if("function"==typeof e.addEventListener)return r=function(){n(f.apply(null,arguments))},s((function(){e.removeEventListener(t,r)})),void e.addEventListener(t,r,{once:!0});var o,a=function(){o&&e.removeListener("error",o),n(f.apply(null,arguments))};"error"!==t&&(o=function(n){e.removeListener(t,a),i(n)},e.once("error",o)),s((function(){o&&e.removeListener("error",o),e.removeListener(t,a)})),e.once(t,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(S,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),"function"==typeof t&&t.amd?t((function(){return A})):e.exports=A}()),Qe;var e}function Ze(){if($e)return Ie;$e=1;var e=ze();Pe();var t=Ke().EventEmitter2;function n(e){e=e||{},this.ros=e.ros,this.name=e.name,this.serviceType=e.serviceType,this.isAdvertised=!1,this._serviceCallback=null}return n.prototype.__proto__=t.prototype,n.prototype.callService=function(t,n,i){if(!this.isAdvertised){var s="call_service:"+this.name+":"+ ++this.ros.idCounter;(n||i)&&this.ros.once(s,(function(t){void 0!==t.result&&!1===t.result?"function"==typeof i&&i(t.values):"function"==typeof n&&n(new e(t.values))}));var r={op:"call_service",id:s,service:this.name,type:this.serviceType,args:t};this.ros.callOnConnection(r)}},n.prototype.advertise=function(e){this.isAdvertised||"function"!=typeof e||(this._serviceCallback=e,this.ros.on(this.name,this._serviceResponse.bind(this)),this.ros.callOnConnection({op:"advertise_service",type:this.serviceType,service:this.name}),this.isAdvertised=!0)},n.prototype.unadvertise=function(){this.isAdvertised&&(this.ros.callOnConnection({op:"unadvertise_service",service:this.name}),this.isAdvertised=!1)},n.prototype._serviceResponse=function(t){var n={},i=this._serviceCallback(t.args,n),s={op:"service_response",service:this.name,values:new e(n),result:i};t.id&&(s.id=t.id),this.ros.callOnConnection(s)},Ie=n}function et(){if(Ue)return Je;Ue=1;var e=oe(),t=_e(),n=Fe(),i=Ze(),s=Pe(),r=ne,o=Ke().EventEmitter2;function a(e){e=e||{};var t=this;this.socket=null,this.idCounter=0,this.isConnected=!1,this.transportLibrary=e.transportLibrary||"websocket",this.transportOptions=e.transportOptions||{},this._sendFunc=function(e){t.sendEncodedMessage(e)},void 0===e.groovyCompatibility?this.groovyCompatibility=!0:this.groovyCompatibility=e.groovyCompatibility,this.setMaxListeners(0),e.url&&this.connect(e.url)}return a.prototype.__proto__=o.prototype,a.prototype.connect=function(i){if("socket.io"===this.transportLibrary)this.socket=r(io(i,{"force new connection":!0}),n(this)),this.socket.on("connect",this.socket.onopen),this.socket.on("data",this.socket.onmessage),this.socket.on("close",this.socket.onclose),this.socket.on("error",this.socket.onerror);else if("RTCPeerConnection"===this.transportLibrary.constructor.name)this.socket=r(this.transportLibrary.createDataChannel(i,this.transportOptions),n(this));else if("websocket"===this.transportLibrary){if(!this.socket||this.socket.readyState===e.CLOSED){var s=new e(i);s.binaryType="arraybuffer",this.socket=r(s,n(this))}}else{if("workersocket"!==this.transportLibrary)throw"Unknown transportLibrary: "+this.transportLibrary.toString();this.socket=r(new t(i),n(this))}},a.prototype.close=function(){this.socket&&this.socket.close()},a.prototype.authenticate=function(e,t,n,i,s,r,o){var a={op:"auth",mac:e,client:t,dest:n,rand:i,t:s,level:r,end:o};this.callOnConnection(a)},a.prototype.sendEncodedMessage=function(e){var t=null,n=this;t="socket.io"===this.transportLibrary?function(e){n.socket.emit("operation",e)}:function(e){n.socket.send(e)},this.isConnected?t(e):n.once("connection",(function(){t(e)}))},a.prototype.callOnConnection=function(e){this.transportOptions.encoder?this.transportOptions.encoder(e,this._sendFunc):this._sendFunc(JSON.stringify(e))},a.prototype.setStatusLevel=function(e,t){var n={op:"set_level",level:e,id:t};this.callOnConnection(n)},a.prototype.getActionServers=function(e,t){var n=new i({ros:this,name:"/rosapi/action_servers",serviceType:"rosapi/GetActionServers"}),r=new s({});"function"==typeof t?n.callService(r,(function(t){e(t.action_servers)}),(function(e){t(e)})):n.callService(r,(function(t){e(t.action_servers)}))},a.prototype.getTopics=function(e,t){var n=new i({ros:this,name:"/rosapi/topics",serviceType:"rosapi/Topics"}),r=new s;"function"==typeof t?n.callService(r,(function(t){e(t)}),(function(e){t(e)})):n.callService(r,(function(t){e(t)}))},a.prototype.getTopicsForType=function(e,t,n){var r=new i({ros:this,name:"/rosapi/topics_for_type",serviceType:"rosapi/TopicsForType"}),o=new s({type:e});"function"==typeof n?r.callService(o,(function(e){t(e.topics)}),(function(e){n(e)})):r.callService(o,(function(e){t(e.topics)}))},a.prototype.getServices=function(e,t){var n=new i({ros:this,name:"/rosapi/services",serviceType:"rosapi/Services"}),r=new s;"function"==typeof t?n.callService(r,(function(t){e(t.services)}),(function(e){t(e)})):n.callService(r,(function(t){e(t.services)}))},a.prototype.getServicesForType=function(e,t,n){var r=new i({ros:this,name:"/rosapi/services_for_type",serviceType:"rosapi/ServicesForType"}),o=new s({type:e});"function"==typeof n?r.callService(o,(function(e){t(e.services)}),(function(e){n(e)})):r.callService(o,(function(e){t(e.services)}))},a.prototype.getServiceRequestDetails=function(e,t,n){var r=new i({ros:this,name:"/rosapi/service_request_details",serviceType:"rosapi/ServiceRequestDetails"}),o=new s({type:e});"function"==typeof n?r.callService(o,(function(e){t(e)}),(function(e){n(e)})):r.callService(o,(function(e){t(e)}))},a.prototype.getServiceResponseDetails=function(e,t,n){var r=new i({ros:this,name:"/rosapi/service_response_details",serviceType:"rosapi/ServiceResponseDetails"}),o=new s({type:e});"function"==typeof n?r.callService(o,(function(e){t(e)}),(function(e){n(e)})):r.callService(o,(function(e){t(e)}))},a.prototype.getNodes=function(e,t){var n=new i({ros:this,name:"/rosapi/nodes",serviceType:"rosapi/Nodes"}),r=new s;"function"==typeof t?n.callService(r,(function(t){e(t.nodes)}),(function(e){t(e)})):n.callService(r,(function(t){e(t.nodes)}))},a.prototype.getNodeDetails=function(e,t,n){var r=new i({ros:this,name:"/rosapi/node_details",serviceType:"rosapi/NodeDetails"}),o=new s({node:e});"function"==typeof n?r.callService(o,(function(e){t(e.subscribing,e.publishing,e.services)}),(function(e){n(e)})):r.callService(o,(function(e){t(e)}))},a.prototype.getParams=function(e,t){var n=new i({ros:this,name:"/rosapi/get_param_names",serviceType:"rosapi/GetParamNames"}),r=new s;"function"==typeof t?n.callService(r,(function(t){e(t.names)}),(function(e){t(e)})):n.callService(r,(function(t){e(t.names)}))},a.prototype.getTopicType=function(e,t,n){var r=new i({ros:this,name:"/rosapi/topic_type",serviceType:"rosapi/TopicType"}),o=new s({topic:e});"function"==typeof n?r.callService(o,(function(e){t(e.type)}),(function(e){n(e)})):r.callService(o,(function(e){t(e.type)}))},a.prototype.getServiceType=function(e,t,n){var r=new i({ros:this,name:"/rosapi/service_type",serviceType:"rosapi/ServiceType"}),o=new s({service:e});"function"==typeof n?r.callService(o,(function(e){t(e.type)}),(function(e){n(e)})):r.callService(o,(function(e){t(e.type)}))},a.prototype.getMessageDetails=function(e,t,n){var r=new i({ros:this,name:"/rosapi/message_details",serviceType:"rosapi/MessageDetails"}),o=new s({type:e});"function"==typeof n?r.callService(o,(function(e){t(e.typedefs)}),(function(e){n(e)})):r.callService(o,(function(e){t(e.typedefs)}))},a.prototype.decodeTypeDefs=function(e){var t=this,n=function(e,i){for(var s={},r=0;r<e.fieldnames.length;r++){var o=e.fieldarraylen[r],a=e.fieldnames[r],c=e.fieldtypes[r];if(-1===c.indexOf("/"))s[a]=-1===o?c:[c];else{for(var l=!1,u=0;u<i.length;u++)if(i[u].type.toString()===c.toString()){l=i[u];break}if(l){var h=n(l,i);-1===o||(s[a]=[h])}else t.emit("error","Cannot find "+c+" in decodeTypeDefs")}}return s};return n(e[0],e)},a.prototype.getTopicsAndRawTypes=function(e,t){var n=new i({ros:this,name:"/rosapi/topics_and_raw_types",serviceType:"rosapi/TopicsAndRawTypes"}),r=new s;"function"==typeof t?n.callService(r,(function(t){e(t)}),(function(e){t(e)})):n.callService(r,(function(t){e(t)}))},Je=a}function tt(){if(Be)return Ge;Be=1;var e=ne;return Ge=function(t){e(this,t)}}function nt(){if(He)return qe;He=1;var e=Ke().EventEmitter2,t=tt();function n(e){e=e||{},this.ros=e.ros,this.name=e.name,this.messageType=e.messageType,this.isAdvertised=!1,this.compression=e.compression||"none",this.throttle_rate=e.throttle_rate||0,this.latch=e.latch||!1,this.queue_size=e.queue_size||100,this.queue_length=e.queue_length||0,this.reconnect_on_close=void 0===e.reconnect_on_close||e.reconnect_on_close,this.compression&&"png"!==this.compression&&"cbor"!==this.compression&&"cbor-raw"!==this.compression&&"none"!==this.compression&&(this.emit("warning",this.compression+" compression is not supported. No compression will be used."),this.compression="none"),this.throttle_rate<0&&(this.emit("warning",this.throttle_rate+" is not allowed. Set to 0"),this.throttle_rate=0);var n=this;this.reconnect_on_close?this.callForSubscribeAndAdvertise=function(e){n.ros.callOnConnection(e),n.waitForReconnect=!1,n.reconnectFunc=function(){n.waitForReconnect||(n.waitForReconnect=!0,n.ros.callOnConnection(e),n.ros.once("connection",(function(){n.waitForReconnect=!1})))},n.ros.on("close",n.reconnectFunc)}:this.callForSubscribeAndAdvertise=this.ros.callOnConnection,this._messageCallback=function(e){n.emit("message",new t(e))}}return n.prototype.__proto__=e.prototype,n.prototype.subscribe=function(e){"function"==typeof e&&this.on("message",e),this.subscribeId||(this.ros.on(this.name,this._messageCallback),this.subscribeId="subscribe:"+this.name+":"+ ++this.ros.idCounter,this.callForSubscribeAndAdvertise({op:"subscribe",id:this.subscribeId,type:this.messageType,topic:this.name,compression:this.compression,throttle_rate:this.throttle_rate,queue_length:this.queue_length}))},n.prototype.unsubscribe=function(e){e&&(this.off("message",e),this.listeners("message").length)||this.subscribeId&&(this.ros.off(this.name,this._messageCallback),this.reconnect_on_close&&this.ros.off("close",this.reconnectFunc),this.emit("unsubscribe"),this.ros.callOnConnection({op:"unsubscribe",id:this.subscribeId,topic:this.name}),this.subscribeId=null)},n.prototype.advertise=function(){if(!this.isAdvertised&&(this.advertiseId="advertise:"+this.name+":"+ ++this.ros.idCounter,this.callForSubscribeAndAdvertise({op:"advertise",id:this.advertiseId,type:this.messageType,topic:this.name,latch:this.latch,queue_size:this.queue_size}),this.isAdvertised=!0,!this.reconnect_on_close)){var e=this;this.ros.on("close",(function(){e.isAdvertised=!1}))}},n.prototype.unadvertise=function(){this.isAdvertised&&(this.reconnect_on_close&&this.ros.off("close",this.reconnectFunc),this.emit("unadvertise"),this.ros.callOnConnection({op:"unadvertise",id:this.advertiseId,topic:this.name}),this.isAdvertised=!1)},n.prototype.publish=function(e){this.isAdvertised||this.advertise(),this.ros.idCounter++;var t={op:"publish",id:"publish:"+this.name+":"+this.ros.idCounter,topic:this.name,msg:e,latch:this.latch};this.ros.callOnConnection(t)},qe=n}function it(){if(We)return Ve;We=1;var e=Ze(),t=Pe();function n(e){e=e||{},this.ros=e.ros,this.name=e.name}return n.prototype.get=function(n){var i=new e({ros:this.ros,name:"/rosapi/get_param",serviceType:"rosapi/GetParam"}),s=new t({name:this.name});i.callService(s,(function(e){var t=JSON.parse(e.value);n(t)}))},n.prototype.set=function(n,i){var s=new e({ros:this.ros,name:"/rosapi/set_param",serviceType:"rosapi/SetParam"}),r=new t({name:this.name,value:JSON.stringify(n)});s.callService(r,i)},n.prototype.delete=function(n){var i=new e({ros:this.ros,name:"/rosapi/delete_param",serviceType:"rosapi/DeleteParam"}),s=new t({name:this.name});i.callService(s,n)},Ve=n}var st,rt,ot,at,ct,lt,ut,ht,ft,pt,mt,dt,vt,yt,gt,bt,_t,wt,kt,xt={},Tt={get exports(){return xt},set exports(e){xt=e}};function Et(){if(rt)return st;rt=1;var e=nt(),t=tt(),n=Ke().EventEmitter2;function i(t){var n=this;t=t||{},this.ros=t.ros,this.serverName=t.serverName,this.actionName=t.actionName,this.timeout=t.timeout,this.omitFeedback=t.omitFeedback,this.omitStatus=t.omitStatus,this.omitResult=t.omitResult,this.goals={};var i=!1;this.feedbackListener=new e({ros:this.ros,name:this.serverName+"/feedback",messageType:this.actionName+"Feedback"}),this.statusListener=new e({ros:this.ros,name:this.serverName+"/status",messageType:"actionlib_msgs/GoalStatusArray"}),this.resultListener=new e({ros:this.ros,name:this.serverName+"/result",messageType:this.actionName+"Result"}),this.goalTopic=new e({ros:this.ros,name:this.serverName+"/goal",messageType:this.actionName+"Goal"}),this.cancelTopic=new e({ros:this.ros,name:this.serverName+"/cancel",messageType:"actionlib_msgs/GoalID"}),this.goalTopic.advertise(),this.cancelTopic.advertise(),this.omitStatus||this.statusListener.subscribe((function(e){i=!0,e.status_list.forEach((function(e){var t=n.goals[e.goal_id.id];t&&t.emit("status",e)}))})),this.omitFeedback||this.feedbackListener.subscribe((function(e){var t=n.goals[e.status.goal_id.id];t&&(t.emit("status",e.status),t.emit("feedback",e.feedback))})),this.omitResult||this.resultListener.subscribe((function(e){var t=n.goals[e.status.goal_id.id];t&&(t.emit("status",e.status),t.emit("result",e.result))})),this.timeout&&setTimeout((function(){i||n.emit("timeout")}),this.timeout)}return i.prototype.__proto__=n.prototype,i.prototype.cancel=function(){var e=new t;this.cancelTopic.publish(e)},i.prototype.dispose=function(){this.goalTopic.unadvertise(),this.cancelTopic.unadvertise(),this.omitStatus||this.statusListener.unsubscribe(),this.omitFeedback||this.feedbackListener.unsubscribe(),this.omitResult||this.resultListener.unsubscribe()},st=i}function Lt(){if(at)return ot;at=1;var e=nt();tt();var t=Ke().EventEmitter2;function n(t){var n=this;t=t||{},this.ros=t.ros,this.serverName=t.serverName,this.actionName=t.actionName,this.timeout=t.timeout,this.omitFeedback=t.omitFeedback,this.omitStatus=t.omitStatus,this.omitResult=t.omitResult;var i=new e({ros:this.ros,name:this.serverName+"/goal",messageType:this.actionName+"Goal"}),s=new e({ros:this.ros,name:this.serverName+"/feedback",messageType:this.actionName+"Feedback"}),r=new e({ros:this.ros,name:this.serverName+"/status",messageType:"actionlib_msgs/GoalStatusArray"}),o=new e({ros:this.ros,name:this.serverName+"/result",messageType:this.actionName+"Result"});i.subscribe((function(e){n.emit("goal",e)})),r.subscribe((function(e){e.status_list.forEach((function(e){n.emit("status",e)}))})),s.subscribe((function(e){n.emit("status",e.status),n.emit("feedback",e.feedback)})),o.subscribe((function(e){n.emit("status",e.status),n.emit("result",e.result)}))}return n.prototype.__proto__=t.prototype,ot=n}function jt(){if(lt)return ct;lt=1;var e=tt(),t=Ke().EventEmitter2;function n(t){var n=this;this.actionClient=t.actionClient,this.goalMessage=t.goalMessage,this.isFinished=!1;var i=new Date;this.goalID="goal_"+Math.random()+"_"+i.getTime(),this.goalMessage=new e({goal_id:{stamp:{secs:0,nsecs:0},id:this.goalID},goal:this.goalMessage}),this.on("status",(function(e){n.status=e})),this.on("result",(function(e){n.isFinished=!0,n.result=e})),this.on("feedback",(function(e){n.feedback=e})),this.actionClient.goals[this.goalID]=this}return n.prototype.__proto__=t.prototype,n.prototype.send=function(e){var t=this;t.actionClient.goalTopic.publish(t.goalMessage),e&&setTimeout((function(){t.isFinished||t.emit("timeout")}),e)},n.prototype.cancel=function(){var t=new e({id:this.goalID});this.actionClient.cancelTopic.publish(t)},ct=n}function At(){if(ht)return ut;ht=1;var e=nt(),t=tt(),n=Ke().EventEmitter2;function i(n){var i=this;n=n||{},this.ros=n.ros,this.serverName=n.serverName,this.actionName=n.actionName,this.feedbackPublisher=new e({ros:this.ros,name:this.serverName+"/feedback",messageType:this.actionName+"Feedback"}),this.feedbackPublisher.advertise();var s=new e({ros:this.ros,name:this.serverName+"/status",messageType:"actionlib_msgs/GoalStatusArray"});s.advertise(),this.resultPublisher=new e({ros:this.ros,name:this.serverName+"/result",messageType:this.actionName+"Result"}),this.resultPublisher.advertise();var r=new e({ros:this.ros,name:this.serverName+"/goal",messageType:this.actionName+"Goal"}),o=new e({ros:this.ros,name:this.serverName+"/cancel",messageType:"actionlib_msgs/GoalID"});this.statusMessage=new t({header:{stamp:{secs:0,nsecs:100},frame_id:""},status_list:[]}),this.currentGoal=null,this.nextGoal=null,r.subscribe((function(e){i.currentGoal?(i.nextGoal=e,i.emit("cancel")):(i.statusMessage.status_list=[{goal_id:e.goal_id,status:1}],i.currentGoal=e,i.emit("goal",e.goal))}));var a=function(e,t){return!(e.secs>t.secs)&&(e.secs<t.secs||e.nsecs<t.nsecs)};o.subscribe((function(e){0===e.stamp.secs&&0===e.stamp.secs&&""===e.id?(i.nextGoal=null,i.currentGoal&&i.emit("cancel")):(i.currentGoal&&e.id===i.currentGoal.goal_id.id?i.emit("cancel"):i.nextGoal&&e.id===i.nextGoal.goal_id.id&&(i.nextGoal=null),i.nextGoal&&a(i.nextGoal.goal_id.stamp,e.stamp)&&(i.nextGoal=null),i.currentGoal&&a(i.currentGoal.goal_id.stamp,e.stamp)&&i.emit("cancel"))})),setInterval((function(){var e=new Date,t=Math.floor(e.getTime()/1e3),n=Math.round(1e9*(e.getTime()/1e3-t));i.statusMessage.header.stamp.secs=t,i.statusMessage.header.stamp.nsecs=n,s.publish(i.statusMessage)}),500)}return i.prototype.__proto__=n.prototype,i.prototype.setSucceeded=function(e){var n=new t({status:{goal_id:this.currentGoal.goal_id,status:3},result:e});this.resultPublisher.publish(n),this.statusMessage.status_list=[],this.nextGoal?(this.currentGoal=this.nextGoal,this.nextGoal=null,this.emit("goal",this.currentGoal.goal)):this.currentGoal=null},i.prototype.setAborted=function(e){var n=new t({status:{goal_id:this.currentGoal.goal_id,status:4},result:e});this.resultPublisher.publish(n),this.statusMessage.status_list=[],this.nextGoal?(this.currentGoal=this.nextGoal,this.nextGoal=null,this.emit("goal",this.currentGoal.goal)):this.currentGoal=null},i.prototype.sendFeedback=function(e){var n=new t({status:{goal_id:this.currentGoal.goal_id,status:1},feedback:e});this.feedbackPublisher.publish(n)},i.prototype.setPreempted=function(){this.statusMessage.status_list=[];var e=new t({status:{goal_id:this.currentGoal.goal_id,status:2}});this.resultPublisher.publish(e),this.nextGoal?(this.currentGoal=this.nextGoal,this.nextGoal=null,this.emit("goal",this.currentGoal.goal)):this.currentGoal=null},ut=i}function St(){if(mt)return pt;function e(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0}return mt=1,e.prototype.add=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},e.prototype.subtract=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},e.prototype.multiplyQuaternion=function(e){var t=e.w*this.x+e.y*this.z-e.z*this.y,n=e.w*this.y+e.z*this.x-e.x*this.z,i=e.w*this.z+e.x*this.y-e.y*this.x,s=-e.x*this.x-e.y*this.y-e.z*this.z;this.x=t*e.w+s*-e.x+n*-e.z-i*-e.y,this.y=n*e.w+s*-e.y+i*-e.x-t*-e.z,this.z=i*e.w+s*-e.z+t*-e.y-n*-e.x},e.prototype.clone=function(){return new e(this)},pt=e}function Mt(){if(vt)return dt;function e(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0,this.w="number"==typeof e.w?e.w:1}return vt=1,e.prototype.conjugate=function(){this.x*=-1,this.y*=-1,this.z*=-1},e.prototype.norm=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},e.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e)},e.prototype.invert=function(){this.conjugate(),this.normalize()},e.prototype.multiply=function(e){var t=this.x*e.w+this.y*e.z-this.z*e.y+this.w*e.x,n=-this.x*e.z+this.y*e.w+this.z*e.x+this.w*e.y,i=this.x*e.y-this.y*e.x+this.z*e.w+this.w*e.z,s=-this.x*e.x-this.y*e.y-this.z*e.z+this.w*e.w;this.x=t,this.y=n,this.z=i,this.w=s},e.prototype.clone=function(){return new e(this)},dt=e}function Ct(){if(gt)return yt;gt=1;var e=St(),t=Mt();function n(n){n=n||{},this.position=new e(n.position),this.orientation=new t(n.orientation)}return n.prototype.applyTransform=function(e){this.position.multiplyQuaternion(e.rotation),this.position.add(e.translation);var t=e.rotation.clone();t.multiply(this.orientation),this.orientation=t},n.prototype.clone=function(){return new n(this)},n.prototype.multiply=function(e){var t=e.clone();return t.applyTransform({rotation:this.orientation,translation:this.position}),t},n.prototype.getInverse=function(){var e=this.clone();return e.orientation.invert(),e.position.multiplyQuaternion(e.orientation),e.position.x*=-1,e.position.y*=-1,e.position.z*=-1,e},yt=n}function Ot(){if(_t)return bt;_t=1;var e=St(),t=Mt();function n(n){n=n||{},this.translation=new e(n.translation),this.rotation=new t(n.rotation)}return n.prototype.clone=function(){return new n(this)},bt=n}var Rt,Nt,Ft,zt,Pt,Dt,It,$t,Jt,Ut,Gt,Bt,qt,Ht,Vt,Wt,Yt,Qt,Xt,Kt,Zt,en,tn,nn={},sn={get exports(){return nn},set exports(e){nn=e}};function rn(){if(Nt)return Rt;Nt=1;var e=Et(),t=jt(),n=Ze(),i=Pe(),s=nt(),r=Ot();function o(t){t=t||{},this.ros=t.ros,this.fixedFrame=t.fixedFrame||"/base_link",this.angularThres=t.angularThres||2,this.transThres=t.transThres||.01,this.rate=t.rate||10,this.updateDelay=t.updateDelay||50;var i=t.topicTimeout||2,s=Math.floor(i),r=Math.floor(1e9*(i-s));this.topicTimeout={secs:s,nsecs:r},this.serverName=t.serverName||"/tf2_web_republisher",this.repubServiceName=t.repubServiceName||"/republish_tfs",this.currentGoal=!1,this.currentTopic=!1,this.frameInfos={},this.republisherUpdateRequested=!1,this._subscribeCB=null,this._isDisposed=!1,this.actionClient=new e({ros:t.ros,serverName:this.serverName,actionName:"tf2_web_republisher/TFSubscriptionAction",omitStatus:!0,omitResult:!0}),this.serviceClient=new n({ros:t.ros,name:this.repubServiceName,serviceType:"tf2_web_republisher/RepublishTFs"})}return o.prototype.processTFArray=function(e){e.transforms.forEach((function(e){var t=e.child_frame_id;"/"===t[0]&&(t=t.substring(1));var n=this.frameInfos[t];n&&(n.transform=new r({translation:e.transform.translation,rotation:e.transform.rotation}),n.cbs.forEach((function(e){e(n.transform)})))}),this)},o.prototype.updateGoal=function(){var e={source_frames:Object.keys(this.frameInfos),target_frame:this.fixedFrame,angular_thres:this.angularThres,trans_thres:this.transThres,rate:this.rate};if(this.ros.groovyCompatibility)this.currentGoal&&this.currentGoal.cancel(),this.currentGoal=new t({actionClient:this.actionClient,goalMessage:e}),this.currentGoal.on("feedback",this.processTFArray.bind(this)),this.currentGoal.send();else{e.timeout=this.topicTimeout;var n=new i(e);this.serviceClient.callService(n,this.processResponse.bind(this))}this.republisherUpdateRequested=!1},o.prototype.processResponse=function(e){this._isDisposed||(this.currentTopic&&this.currentTopic.unsubscribe(this._subscribeCB),this.currentTopic=new s({ros:this.ros,name:e.topic_name,messageType:"tf2_web_republisher/TFArray"}),this._subscribeCB=this.processTFArray.bind(this),this.currentTopic.subscribe(this._subscribeCB))},o.prototype.subscribe=function(e,t){"/"===e[0]&&(e=e.substring(1)),this.frameInfos[e]?this.frameInfos[e].transform&&t(this.frameInfos[e].transform):(this.frameInfos[e]={cbs:[]},this.republisherUpdateRequested||(setTimeout(this.updateGoal.bind(this),this.updateDelay),this.republisherUpdateRequested=!0)),this.frameInfos[e].cbs.push(t)},o.prototype.unsubscribe=function(e,t){"/"===e[0]&&(e=e.substring(1));for(var n=this.frameInfos[e],i=n&&n.cbs||[],s=i.length;s--;)i[s]===t&&i.splice(s,1);t&&0!==i.length||delete this.frameInfos[e]},o.prototype.dispose=function(){this._isDisposed=!0,this.actionClient.dispose(),this.currentTopic&&this.currentTopic.unsubscribe(this._subscribeCB)},Rt=o}function on(){return Pt?zt:(Pt=1,zt={URDF_SPHERE:0,URDF_BOX:1,URDF_CYLINDER:2,URDF_MESH:3})}function an(){if(It)return Dt;It=1;var e=St(),t=on();return Dt=function(n){this.dimension=null,this.type=t.URDF_BOX;var i=n.xml.getAttribute("size").split(" ");this.dimension=new e({x:parseFloat(i[0]),y:parseFloat(i[1]),z:parseFloat(i[2])})}}function cn(){if(Jt)return $t;return Jt=1,$t=function(e){var t=e.xml.getAttribute("rgba").split(" ");this.r=parseFloat(t[0]),this.g=parseFloat(t[1]),this.b=parseFloat(t[2]),this.a=parseFloat(t[3])}}function ln(){if(Gt)return Ut;Gt=1;var e=on();return Ut=function(t){this.type=e.URDF_CYLINDER,this.length=parseFloat(t.xml.getAttribute("length")),this.radius=parseFloat(t.xml.getAttribute("radius"))}}function un(){if(qt)return Bt;qt=1;var e=cn();function t(t){this.textureFilename=null,this.color=null,this.name=t.xml.getAttribute("name");var n=t.xml.getElementsByTagName("texture");n.length>0&&(this.textureFilename=n[0].getAttribute("filename"));var i=t.xml.getElementsByTagName("color");i.length>0&&(this.color=new e({xml:i[0]}))}t.prototype.isLink=function(){return null===this.color&&null===this.textureFilename};var n=ne;return t.prototype.assign=function(e){return n(this,e)},Bt=t}function hn(){if(Vt)return Ht;Vt=1;var e=St(),t=on();return Ht=function(n){this.scale=null,this.type=t.URDF_MESH,this.filename=n.xml.getAttribute("filename");var i=n.xml.getAttribute("scale");if(i){var s=i.split(" ");this.scale=new e({x:parseFloat(s[0]),y:parseFloat(s[1]),z:parseFloat(s[2])})}}}function fn(){if(Yt)return Wt;Yt=1;var e=on();return Wt=function(t){this.type=e.URDF_SPHERE,this.radius=parseFloat(t.xml.getAttribute("radius"))}}function pn(){if(Xt)return Qt;Xt=1;var e=Ct(),t=St(),n=Mt(),i=ln(),s=an(),r=un(),o=hn(),a=fn();return Qt=function(c){var l=c.xml;this.origin=null,this.geometry=null,this.material=null,this.name=c.xml.getAttribute("name");var u=l.getElementsByTagName("origin");if(0===u.length)this.origin=new e;else{var h=u[0].getAttribute("xyz"),f=new t;h&&(h=h.split(" "),f=new t({x:parseFloat(h[0]),y:parseFloat(h[1]),z:parseFloat(h[2])}));var p=u[0].getAttribute("rpy"),m=new n;if(p){p=p.split(" ");var d=parseFloat(p[0])/2,v=parseFloat(p[1])/2,y=parseFloat(p[2])/2,g=Math.sin(d)*Math.cos(v)*Math.cos(y)-Math.cos(d)*Math.sin(v)*Math.sin(y),b=Math.cos(d)*Math.sin(v)*Math.cos(y)+Math.sin(d)*Math.cos(v)*Math.sin(y),_=Math.cos(d)*Math.cos(v)*Math.sin(y)-Math.sin(d)*Math.sin(v)*Math.cos(y),w=Math.cos(d)*Math.cos(v)*Math.cos(y)+Math.sin(d)*Math.sin(v)*Math.sin(y);(m=new n({x:g,y:b,z:_,w:w})).normalize()}this.origin=new e({position:f,orientation:m})}var k=l.getElementsByTagName("geometry");if(k.length>0){for(var x=k[0],T=null,E=0;E<x.childNodes.length;E++){var L=x.childNodes[E];if(1===L.nodeType){T=L;break}}var j=T.nodeName;"sphere"===j?this.geometry=new a({xml:T}):"box"===j?this.geometry=new s({xml:T}):"cylinder"===j?this.geometry=new i({xml:T}):"mesh"===j?this.geometry=new o({xml:T}):console.warn("Unknown geometry type "+j)}var A=l.getElementsByTagName("material");A.length>0&&(this.material=new r({xml:A[0]}))}}function mn(){if(Zt)return Kt;Zt=1;var e=pn();return Kt=function(t){this.name=t.xml.getAttribute("name"),this.visuals=[];for(var n=t.xml.getElementsByTagName("visual"),i=0;i<n.length;i++)this.visuals.push(new e({xml:n[i]}))}}var dn,vn,yn,gn,bn,_n={};function wn(){if(yn)return vn;yn=1;var e=un(),t=mn(),n=function(){if(tn)return en;tn=1;var e=Ct(),t=St(),n=Mt();return en=function(i){this.name=i.xml.getAttribute("name"),this.type=i.xml.getAttribute("type");var s=i.xml.getElementsByTagName("parent");s.length>0&&(this.parent=s[0].getAttribute("link"));var r=i.xml.getElementsByTagName("child");r.length>0&&(this.child=r[0].getAttribute("link"));var o=i.xml.getElementsByTagName("limit");o.length>0&&(this.minval=parseFloat(o[0].getAttribute("lower")),this.maxval=parseFloat(o[0].getAttribute("upper")));var a=i.xml.getElementsByTagName("origin");if(0===a.length)this.origin=new e;else{var c=a[0].getAttribute("xyz"),l=new t;c&&(c=c.split(" "),l=new t({x:parseFloat(c[0]),y:parseFloat(c[1]),z:parseFloat(c[2])}));var u=a[0].getAttribute("rpy"),h=new n;if(u){u=u.split(" ");var f=parseFloat(u[0])/2,p=parseFloat(u[1])/2,m=parseFloat(u[2])/2,d=Math.sin(f)*Math.cos(p)*Math.cos(m)-Math.cos(f)*Math.sin(p)*Math.sin(m),v=Math.cos(f)*Math.sin(p)*Math.cos(m)+Math.sin(f)*Math.cos(p)*Math.sin(m),y=Math.cos(f)*Math.cos(p)*Math.sin(m)-Math.sin(f)*Math.sin(p)*Math.cos(m),g=Math.cos(f)*Math.cos(p)*Math.cos(m)+Math.sin(f)*Math.sin(p)*Math.sin(m);(h=new n({x:d,y:v,z:y,w:g})).normalize()}this.origin=new e({position:l,orientation:h})}},en}(),i=(dn||(dn=1,_n.DOMImplementation=window.DOMImplementation,_n.XMLSerializer=window.XMLSerializer,_n.DOMParser=window.DOMParser),_n).DOMParser;return vn=function(s){var r=(s=s||{}).xml,o=s.string;this.materials={},this.links={},this.joints={},o&&(r=(new i).parseFromString(o,"text/xml"));var a=r.documentElement;this.name=a.getAttribute("name");for(var c=a.childNodes,l=0;l<c.length;l++){var u=c[l];if("material"===u.tagName){var h=new e({xml:u});void 0!==this.materials[h.name]?this.materials[h.name].isLink()?this.materials[h.name].assign(h):console.warn("Material "+h.name+"is not unique."):this.materials[h.name]=h}else if("link"===u.tagName){var f=new t({xml:u});if(void 0!==this.links[f.name])console.warn("Link "+f.name+" is not unique.");else{for(var p=0;p<f.visuals.length;p++){var m=f.visuals[p].material;null!==m&&m.name&&(void 0!==this.materials[m.name]?f.visuals[p].material=this.materials[m.name]:this.materials[m.name]=m)}this.links[f.name]=f}}else if("joint"===u.tagName){var d=new n({xml:u});this.joints[d.name]=d}}}}var kn=H.ROSLIB||{REVISION:"1.3.0"},xn=ne;xn(kn,function(){if(Ye)return ie;Ye=1;var e=re(),t=se.exports={Ros:et(),Topic:nt(),Message:tt(),Param:it(),Service:Ze(),ServiceRequest:Pe(),ServiceResponse:ze()};return e(t.Ros,["Param","Service","Topic"],t),ie}()),xn(kn,function(){if(ft)return xt;ft=1;var e=et();return re()(e,["ActionClient","SimpleActionServer"],Tt.exports={ActionClient:Et(),ActionListener:Lt(),Goal:jt(),SimpleActionServer:At()}),xt}()),xn(kn,kt?wt:(kt=1,wt={Pose:Ct(),Quaternion:Mt(),Transform:Ot(),Vector3:St()})),xn(kn,function(){if(Ft)return nn;Ft=1;var e=et();return re()(e,["TFClient"],sn.exports={TFClient:rn()}),nn}()),xn(kn,bn?gn:(bn=1,gn=ne({UrdfBox:an(),UrdfColor:cn(),UrdfCylinder:ln(),UrdfLink:mn(),UrdfMaterial:un(),UrdfMesh:hn(),UrdfModel:wn(),UrdfSphere:fn(),UrdfVisual:pn()},on())));var Tn=kn;const En="jibo",Ln={0:{name:"red",value:{x:255,y:0,z:0}},1:{name:"yellow",value:{x:255,y:69,z:0}},2:{name:"green",value:{x:0,y:167,z:0}},3:{name:"cyan",value:{x:0,y:167,z:48}},4:{name:"blue",value:{x:0,y:0,z:255}},5:{name:"magenta",value:{x:255,y:0,z:163}},6:{name:"white",value:{x:255,y:255,z:255}},7:{name:"random",value:{x:-1,y:-1,z:-1}}},jn={0:{name:"BackStep",file:"Dances/Back_Stepper_01_01.keys"},1:{name:"Carlton",file:"Dances/Carlton_01_01.keys"},2:{name:"Celebrate",file:"Dances/Celebrate_01.keys"},3:{name:"Clockworker",file:"Dances/Clockworker_01_01.keys"},4:{name:"Doughkneader",file:"Dances/Doughkneader_01_01.keys"},5:{name:"Footstomper",file:"Dances/Footstomper_01_01.keys"},6:{name:"Happy",file:"Dances/Happy_Lucky_01_01.keys"},7:{name:"Headbanger",file:"Dances/Headbanger_01_01.keys"},8:{name:"Headdipper",file:"Dances/Headdipper_01_01.keys"},9:{name:"Pigeon",file:"Dances/Pigeon_01_01.keys"},10:{name:"Slow",file:"Dances/Prom_Night_01_01.keys"},11:{name:"Robot",file:"Dances/Robotic_01_01.keys"},12:{name:"Rocking Chair",file:"Dances/Rocking_Chair_01.keys"},13:{name:"Roxbury",file:"Dances/Roxbury_01_01.keys"},14:{name:"Samba",file:"Dances/Samba_01_01.keys"},15:{name:"Seaweed",file:"Dances/Seaweed_01_01.keys"},16:{name:"Slideshow",file:"Dances/SlideshowDance_01_01.keys"},17:{name:"Waltz",file:"Dances/Waltz_01_01.keys"},18:{name:"Disco",file:"Dances/dance_disco_00.keys"}};var An;!function(e){e[e.Embarassed=0]="Embarassed",e[e.Frustrated=1]="Frustrated",e[e.Laugh=2]="Laugh",e[e.Sad=3]="Sad",e[e.Thinking=4]="Thinking",e[e.Happy=5]="Happy",e[e.SadEyes=6]="SadEyes",e[e.Interested=7]="Interested",e[e.Curious=8]="Curious",e[e.No=9]="No",e[e.Yes=10]="Yes",e[e.Puzzled=11]="Puzzled",e[e.Relieved=12]="Relieved",e[e.Success=13]="Success"}(An||(An={}));const Sn={[An.Embarassed]:{name:"embarassed",file:"Misc/embarassed_01_02.keys"},[An.Frustrated]:{name:"frustrated",file:"Misc/Frustrated_01_04.keys"},[An.Laugh]:{name:"laugh",file:"Misc/Laughter_01_03.keys"},[An.Sad]:{name:"sad",file:"Misc/Sad_03.keys"},[An.Thinking]:{name:"thinking",file:"Misc/thinking_08.keys"},[An.Happy]:{name:"happy",file:"Misc/Eye_to_Happy_02.keys"},[An.SadEyes]:{name:"sad eyes",file:"Misc/Eye_Sad_03_02.keys"},[An.Interested]:{name:"interested",file:"Misc/interested_01.keys"},[An.Curious]:{name:"curious",file:"Misc/Question_01_02.keys"},[An.No]:{name:"no",file:"Misc/no_4.keys"},[An.Yes]:{name:"yes",file:"Misc/yep_02.keys"},[An.Puzzled]:{name:"puzzled",file:"Misc/puzzled_01_02.keys"},[An.Relieved]:{name:"relieved",file:"Misc/relieved_01.keys"},[An.Success]:{name:"success",file:"Misc/success_02.keys"}};var Mn;!function(e){e[e.Airplane=0]="Airplane",e[e.Apple=1]="Apple",e[e.Art=2]="Art",e[e.Bowling=3]="Bowling",e[e.Correct=4]="Correct",e[e.Exclamation=5]="Exclamation",e[e.Football=6]="Football",e[e.Heart=7]="Heart",e[e.Magic=8]="Magic",e[e.Ocean=9]="Ocean",e[e.Penguin=10]="Penguin",e[e.Rainbow=11]="Rainbow",e[e.Robot=12]="Robot",e[e.Rocket=13]="Rocket",e[e.Snowflake=14]="Snowflake",e[e.Taco=15]="Taco",e[e.VideoGame=16]="VideoGame"}(Mn||(Mn={}));const Cn={[Mn.Airplane]:{name:"airplane",file:"Emoji/Emoji_Airplane_01_01.keys"},[Mn.Apple]:{name:"apple",file:"Emoji/Emoji_AppleRed_01_01.keys"},[Mn.Art]:{name:"art",file:"Emoji/Emoji_Art_01_01.keys"},[Mn.Bowling]:{name:"bowling",file:"Emoji/Emoji_Bowling.keys"},[Mn.Correct]:{name:"correct",file:"Emoji/Emoji_Checkmark_01_01.keys"},[Mn.Exclamation]:{name:"exclamation",file:"Emoji/Emoji_ExclamationYellow.keys"},[Mn.Football]:{name:"football",file:"Emoji/Emoji_Football_01_01.keys"},[Mn.Heart]:{name:"heart",file:"Emoji/Emoji_HeartArrow_01_01.keys"},[Mn.Magic]:{name:"magic",file:"Emoji/Emoji_Magic_01_02.keys"},[Mn.Ocean]:{name:"ocean",file:"Emoji/Emoji_Ocean_01_01.keys"},[Mn.Penguin]:{name:"penguin",file:"Emoji/Emoji_Penguin_01_01.keys"},[Mn.Rainbow]:{name:"rainbow",file:"Emoji/Emoji_Rainbow_01_01.keys"},[Mn.Robot]:{name:"robot",file:"Emoji/Emoji_Robot_01_01.keys"},[Mn.Rocket]:{name:"rocket",file:"Emoji/Emoji_Rocket_01_01.keys"},[Mn.Snowflake]:{name:"snowflake",file:"Emoji/Emoji_Snowflake_01_01.keys"},[Mn.Taco]:{name:"taco",file:"Emoji/Emoji_Taco_01_01.keys"},[Mn.VideoGame]:{name:"video game",file:"Emoji/Emoji_VideoGame_01_01.keys"}};class On extends t.Extension{init(e){this.text="Hello! I'm Jibo!",this.animName="My Animation",this.multitask=!1,this.prevTasks=[],this.multitask_msg={},this.busy=!1,this.dances=Object.entries(jn).map((([e,t])=>({value:parseInt(e),text:t.name}))),this.runtime.registerPeripheralExtension(En,this),this.runtime.connectPeripheral(En,0),this.ros=null,this.connected=!1,this.failed=!1,this.rosbridgeIP="ws://localhost:9090",this.jbVolume="60",this.asr_out="",this.jiboEvent=new $,this.tts=[],this.RosConnect({rosIP:"localhost"}),this.getAnimationList=()=>this.animation_list.map((e=>({text:e,value:e})))}checkBusy(e){var t=new Tn.Topic({ros:this.ros,name:"/jibo_state",messageType:"jibo_msgs/JiboState"});t.subscribe((function(n){e.busy=n.is_playing_sound,t.unsubscribe()}))}defineTranslations(){}defineBlocks(){return{JiboTTS:e=>({type:t.BlockType.Command,arg:{type:t.ArgumentType.String,defaultValue:"Hello, I am Jibo"},text:e=>`say ${e}`,operation:e=>this.JiboTTS(this,e)}),JiboAsk:e=>({type:t.BlockType.Command,arg:{type:t.ArgumentType.String,defaultValue:"How are you?"},text:e=>`ask ${e} and wait`,operation:e=>this.JiboAsk(e)}),JiboListen:e=>({type:t.BlockType.Reporter,text:"answer",operation:()=>this.JiboListen()}),JiboDance:e=>({type:t.BlockType.Command,arg:{type:t.ArgumentType.Number,options:e.dances},text:e=>`set Jibo dance to ${e}`,operation:e=>{this.JiboDance(e)}}),JiboEmoji:e=>({type:t.BlockType.Command,arg:this.makeCustomArgument({component:"EmojiArgument",initial:{value:An.Happy,text:"happy"}}),text:e=>`set Jibo emoji to ${e}`,operation:e=>this.JiboEmoji(e)}),JiboIcon:e=>({type:t.BlockType.Command,arg:this.makeCustomArgument({component:"IconArgument",initial:{value:Mn.Taco,text:"taco"}}),text:e=>`set Jibo icon to ${e}`,operation:e=>this.JiboIcon(e)}),JiboLED:e=>({type:t.BlockType.Command,arg:this.makeCustomArgument({component:"ColorArgument",initial:{value:4,text:"blue"}}),text:e=>`set Jibo LED to ${e}`,operation:e=>{this.JiboLED(e)}}),JiboLook:e=>({type:t.BlockType.Command,args:[{type:t.ArgumentType.String,defaultValue:"0"},{type:t.ArgumentType.String,defaultValue:"0"},{type:t.ArgumentType.String,defaultValue:"0"}],text:(e,t,n)=>`set Jibo Look at ${e}, ${t}, ${n}`,operation:(e,t,n)=>this.JiboLook(e,t,n)}),JiboMultitask:e=>({type:t.BlockType.Command,text:"start multitask",operation:()=>{this.multitask=!0,console.log("starting multitask")}}),JiboEnd:e=>({type:t.BlockType.Command,text:"end multitask",operation:()=>{console.log(this.multitask_msg),this.JiboPublish(this.multitask_msg),this.multitask=!1,this.multitask_msg={},this.prevTasks.length=0,console.log("ending multitask")}})}}connect(){console.log("this.connect")}disconnect(){}scan(){}isConnected(){return console.log("isConnected status: "+this.connected),this.connected}RosConnect(e){const t=e.rosIP.toString();if(this.rosbridgeIP="ws://"+t+":9090",!this.connected){this.ros=new Tn.Ros({url:this.rosbridgeIP});let e=function(e){return function(){e.connected=!0,e.JiboTTS({TEXT:"Hello there. Welcome to A.I. Blocks."})}}(this);this.ros.on("connection",(function(){e()}));let t=function(e){return function(){e.failed=!0}}(this);this.ros.on("error",(function(e){t()}));let n=function(e){return function(){e.connected=!1}}(this);this.ros.on("close",(function(){n()}))}return this.JiboState(),this.JiboPublish({do_attention_mode:!0,attention_mode:1,do_anim_transition:!0,anim_transition:0,do_led:!0,led_color:{x:0,y:0,z:0}}),this.JiboASR_reseive(),this.connected}JiboTTS(e,t){return D(this,void 0,void 0,(function*(){if(console.log("multitask: "+e.multitask),e.multitask){if(console.log(this.prevTasks),e.prevTasks.includes("tts")||e.prevTasks.includes("emote")){for(e.prevTasks.length=0,console.log("performing"),console.log(this.multitask_msg);e.busy;)console.log("hello");e.busy=!0,yield e.JiboPublish(e.multitask_msg),e.busy=!1,e.multitask_msg={}}return e.multitask_msg.do_tts=!0,e.multitask_msg.tts_text=t,e.multitask_msg.volume=parseFloat(e.jbVolume),e.prevTasks.push("tts"),void console.log(e.multitask_msg)}for(;e.busy;)console.log(e.busy),this.checkBusy(e);var n={do_tts:!0,tts_text:t,do_lookat:!1,do_motion:!1,volume:parseFloat(this.jbVolume)};yield e.JiboPublish(n)}))}JiboAsk(e){return D(this,void 0,void 0,(function*(){yield this.JiboTTS(this,e),this.JiboASR_request(),this.asr_out=yield this.JiboASR_reseive()}))}JiboListen(){return D(this,void 0,void 0,(function*(){return this.asr_out}))}JiboLED(e){let t=Ln[e].name,n=Ln[e].value;if("random"==t){const e=Math.floor(Math.random()*(Object.keys(Ln).length-1)),t=Object.keys(Ln)[e];n=Ln[t].value}if(this.multitask)return this.prevTasks.includes("led")&&(this.prevTasks.length=0,console.log("performing"),console.log(this.multitask_msg),this.JiboPublish(this.multitask_msg),this.multitask_msg={}),this.multitask_msg.do_led=!0,this.multitask_msg.led_color=n,void this.prevTasks.push("led");var i={do_led:!0,led_color:n};this.JiboPublish(i)}JiboLEDOff(){return D(this,void 0,void 0,(function*(){yield this.JiboPublish({do_led:!0,led_color:{x:0,y:0,z:0}})}))}JiboLook(e,t,n){if(this.multitask)return(this.prevTasks.includes("look")||this.prevTasks.includes("emote")||this.prevTasks.includes("emoji"))&&(console.log("performing"),console.log(this.multitask_msg),this.JiboPublish(this.multitask_msg),this.prevTasks.length=0,this.multitask_msg={}),this.multitask_msg.do_lookat=!0,this.multitask.lookat={x:parseFloat(e),y:parseFloat(t),z:parseFloat(n)},void this.prevTasks.push("look");var i={do_lookat:!0,lookat:{x:parseFloat(e),y:parseFloat(t),z:parseFloat(n)}};this.JiboPublish(i)}JiboEmoji(e){return D(this,void 0,void 0,(function*(){const t=Sn[e].file;yield this.JiboAnim(t)}))}JiboIcon(e){return D(this,void 0,void 0,(function*(){const t=Cn[e].file;yield this.JiboAnim(t)}))}JiboDance(e){return D(this,void 0,void 0,(function*(){const t=jn[e].file;yield this.JiboAnim(t)}))}JiboAnim(e){return D(this,void 0,void 0,(function*(){var t={do_motion:!0,do_tts:!1,do_lookat:!1,motion:e};yield this.JiboPublish(t),yield this.JiboPublish({do_anim_transition:!0,anim_transition:0})}))}JiboMultitask(){return D(this,void 0,void 0,(function*(){return yield this.JiboPublish({do_led:!0,led_color:{x:0,y:255,z:255},do_motion:!0,motion:"Emoji/Emoji_HeartArrow_01_01.keys",do_lookat:!0,lookat:{x:100,y:100,z:100}}),"done"}))}JiboPublish(e){return D(this,void 0,void 0,(function*(){if(!this.connected)return console.log("ROS is not connetced"),!1;var t=new Tn.Topic({ros:this.ros,name:"/jibo",messageType:"jibo_msgs/JiboAction"}),n=new Tn.Message(e);t.publish(n),yield new Promise((e=>setTimeout(e,500)))}))}JiboState(){console.log("listening...");var e=new Tn.Topic({ros:this.ros,name:"/jibo_state",messageType:"jibo_msgs/JiboState"});e.subscribe((function(t){console.log("Received message on "+e.name+": "),console.log(t),e.unsubscribe()}))}JiboASR_request(){if(!this.connected)return console.log("ROS is not connetced"),!1;var e=new Tn.Topic({ros:this.ros,name:"/jibo_asr_command",messageType:"jibo_msgs/JiboAsrCommand"}),t=new Tn.Message({heyjibo:!1,command:1});e.publish(t)}JiboASR_reseive(){return D(this,void 0,void 0,(function*(){return new Promise((e=>{var t=new Tn.Topic({ros:this.ros,name:"/jibo_asr_result",messageType:"jibo_msgs/JiboAsrResult"});t.subscribe((function(n){console.log("Received message on "+t.name+": "),console.log(n),t.unsubscribe(),e(n.transcription)}))}))}))}addAnimationToList(e){return this.animation_list.push(e)}}function Rn(e){f(e,"svelte-v263k0",".colorButton.svelte-v263k0{border-radius:32px;height:64px;width:64px}.color.svelte-v263k0{background-color:var(--color)}#grid.svelte-v263k0{display:grid;grid-template-columns:auto auto auto;grid-gap:10px}@media screen and (max-width: 768px){#grid.svelte-v263k0{grid-template-columns:auto}}")}function Nn(e,t,n){const i=e.slice();return i[6]=t[n],i}function Fn(e){let t,n,i,s,r,o,a=Ln[e[6]].name+"";function c(){return e[5](e[6])}return{c(){var r,o,c,l;t=v("button"),n=y(a),i=g(),_(t,"class","colorButton color svelte-v263k0"),t.disabled=s=e[0]==parseInt(e[6]),r=t,o="--color",null===(c=Ln[e[6]].name)?r.style.removeProperty(o):r.style.setProperty(o,c,l?"important":"")},m(e,s){p(e,t,s),h(t,n),h(t,i),r||(o=b(t,"click",c),r=!0)},p(n,i){e=n,1&i&&s!==(s=e[0]==parseInt(e[6]))&&(t.disabled=s)},d(e){e&&m(t),r=!1,o()}}}function zn(e){let t,i=Object.keys(Ln),s=[];for(let t=0;t<i.length;t+=1)s[t]=Fn(Nn(e,i,t));return{c(){t=v("div");for(let e=0;e<s.length;e+=1)s[e].c();_(t,"id","grid"),_(t,"class","svelte-v263k0")},m(e,n){p(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,[n]){if(1&n){let r;for(i=Object.keys(Ln),r=0;r<i.length;r+=1){const o=Nn(e,i,r);s[r]?s[r].p(o,n):(s[r]=Fn(o),s[r].c(),s[r].m(t,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:n,o:n,d(e){e&&m(t),d(s,e)}}}function Pn(e,t,n){let i,{setter:s}=t,{current:r}=t,{extension:o}=t,a=r.value;return e.$$set=e=>{"setter"in e&&n(1,s=e.setter),"current"in e&&n(2,r=e.current),"extension"in e&&n(3,o=e.extension)},e.$$.update=()=>{1&e.$$.dirty&&n(4,i=Ln[a].name),19&e.$$.dirty&&s({value:a,text:i})},[a,s,r,o,i,e=>n(0,a=parseInt(e))]}function Dn(e){f(e,"svelte-13t3kpx","#grid.svelte-13t3kpx{display:grid;grid-template-columns:auto auto auto auto auto;grid-gap:10px}@media screen and (max-width: 768px){#grid.svelte-13t3kpx{grid-template-columns:auto}}.emoji.svelte-13t3kpx{width:50px}")}function In(e,t,n){const i=e.slice();return i[7]=t[n],i}function $n(e){let t,n,i,s,r,o,a,c;function l(){return e[6](e[7])}return{c(){t=v("button"),n=v("div"),i=v("img"),r=g(),_(i,"class","emoji svelte-13t3kpx"),u(i.src,s=e[1][e[7]])||_(i,"src",s),_(i,"alt",Sn[e[7]].name),_(n,"class","cell"),t.disabled=o=e[0]==parseInt(e[7])},m(e,s){p(e,t,s),h(t,n),h(n,i),h(t,r),a||(c=b(t,"click",l),a=!0)},p(n,i){e=n,1&i&&o!==(o=e[0]==parseInt(e[7]))&&(t.disabled=o)},d(e){e&&m(t),a=!1,c()}}}function Jn(e){let t,i=Object.keys(Sn),s=[];for(let t=0;t<i.length;t+=1)s[t]=$n(In(e,i,t));return{c(){t=v("div");for(let e=0;e<s.length;e+=1)s[e].c();_(t,"id","grid"),_(t,"class","svelte-13t3kpx")},m(e,n){p(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,[n]){if(3&n){let r;for(i=Object.keys(Sn),r=0;r<i.length;r+=1){const o=In(e,i,r);s[r]?s[r].p(o,n):(s[r]=$n(o),s[r].c(),s[r].m(t,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:n,o:n,d(e){e&&m(t),d(s,e)}}}function Un(e,t,n){let i;const s={[An.Curious]:"https://em-content.zobj.net/thumbs/144/apple/325/face-with-raised-eyebrow_1f928.png",[An.Embarassed]:"https://em-content.zobj.net/thumbs/144/apple/325/face-with-hand-over-mouth_1f92d.png",[An.Frustrated]:"https://em-content.zobj.net/thumbs/144/apple/325/confounded-face_1f616.png",[An.Happy]:"https://em-content.zobj.net/thumbs/144/apple/325/grinning-face_1f600.png",[An.Interested]:"https://em-content.zobj.net/thumbs/144/apple/325/star-struck_1f929.png",[An.Laugh]:"https://em-content.zobj.net/thumbs/144/apple/325/face-with-tears-of-joy_1f602.png",[An.No]:"https://em-content.zobj.net/thumbs/144/apple/325/thumbs-down_1f44e.png",[An.Puzzled]:"https://em-content.zobj.net/thumbs/144/apple/325/face-with-diagonal-mouth_1fae4.png",[An.Relieved]:"https://em-content.zobj.net/thumbs/144/apple/325/relieved-face_1f60c.png",[An.Sad]:"https://em-content.zobj.net/thumbs/144/apple/325/slightly-frowning-face_1f641.png",[An.SadEyes]:"https://em-content.zobj.net/thumbs/144/apple/325/pleading-face_1f97a.png",[An.Success]:"https://em-content.zobj.net/thumbs/240/apple/325/check-mark-button_2705.png",[An.Thinking]:"https://em-content.zobj.net/thumbs/144/apple/325/thinking-face_1f914.png",[An.Yes]:"https://em-content.zobj.net/thumbs/144/apple/325/thumbs-up_1f44d.png"};let{setter:r}=t,{current:o}=t,{extension:a}=t,c=o.value;return e.$$set=e=>{"setter"in e&&n(2,r=e.setter),"current"in e&&n(3,o=e.current),"extension"in e&&n(4,a=e.extension)},e.$$.update=()=>{1&e.$$.dirty&&n(5,i=Sn[c].name),37&e.$$.dirty&&r({value:c,text:i})},[c,s,r,o,a,i,e=>n(0,c=parseInt(e))]}function Gn(e){f(e,"svelte-17r18fo","#grid.svelte-17r18fo{display:grid;grid-template-columns:auto auto auto auto auto;grid-gap:10px}@media screen and (max-width: 768px){#grid.svelte-17r18fo{grid-template-columns:auto}}.icon.svelte-17r18fo{width:50px}")}function Bn(e,t,n){const i=e.slice();return i[7]=t[n],i}function qn(e){let t,n,i,s,r,o,a,c;function l(){return e[6](e[7])}return{c(){t=v("button"),n=v("div"),i=v("img"),r=g(),_(i,"class","icon svelte-17r18fo"),u(i.src,s=e[1][e[7]])||_(i,"src",s),_(i,"alt",Cn[e[7]].name),_(n,"class","cell"),t.disabled=o=e[0]==parseInt(e[7])},m(e,s){p(e,t,s),h(t,n),h(n,i),h(t,r),a||(c=b(t,"click",l),a=!0)},p(n,i){e=n,1&i&&o!==(o=e[0]==parseInt(e[7]))&&(t.disabled=o)},d(e){e&&m(t),a=!1,c()}}}function Hn(e){let t,i=Object.keys(Cn),s=[];for(let t=0;t<i.length;t+=1)s[t]=qn(Bn(e,i,t));return{c(){t=v("div");for(let e=0;e<s.length;e+=1)s[e].c();_(t,"id","grid"),_(t,"class","svelte-17r18fo")},m(e,n){p(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,[n]){if(3&n){let r;for(i=Object.keys(Cn),r=0;r<i.length;r+=1){const o=Bn(e,i,r);s[r]?s[r].p(o,n):(s[r]=qn(o),s[r].c(),s[r].m(t,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:n,o:n,d(e){e&&m(t),d(s,e)}}}function Vn(e,t,n){let i;const s={[Mn.Airplane]:"https://cdn.emojidex.com/emoji/seal/airplane.png?1499688727",[Mn.Apple]:"https://images.emojiterra.com/google/noto-emoji/v2.034/512px/1f34e.png",[Mn.Art]:"https://images.emojiterra.com/google/noto-emoji/v2.034/512px/1f3a8.png",[Mn.Bowling]:"https://images.emojiterra.com/google/android-pie/512px/1f3b3.png",[Mn.Correct]:"https://images.emojiterra.com/openmoji/v13.1/512px/2705.png",[Mn.Exclamation]:"https://emojis.wiki/emoji-pics/messenger/exclamation-mark-messenger.png",[Mn.Football]:"https://images.emojiterra.com/google/noto-emoji/v2.034/512px/1f3c8.png",[Mn.Heart]:"https://images.emojiterra.com/openmoji/v13.1/512px/1f498.png",[Mn.Magic]:"https://images.emojiterra.com/google/android-11/512px/1fa84.png",[Mn.Ocean]:"https://emojipedia-us.s3.amazonaws.com/source/skype/289/water-wave_1f30a.png",[Mn.Penguin]:"https://emojipedia-us.s3.amazonaws.com/source/skype/289/penguin_1f427.png",[Mn.Rainbow]:"https://emojipedia-us.s3.amazonaws.com/source/skype/289/rainbow_1f308.png",[Mn.Robot]:"https://images.emojiterra.com/google/android-10/512px/1f916.png",[Mn.Rocket]:"https://images.emojiterra.com/openmoji/v13.1/512px/1f680.png",[Mn.Snowflake]:"https://emojipedia-us.s3.amazonaws.com/source/skype/289/snowflake_2744-fe0f.png",[Mn.Taco]:"https://cdn0.iconfinder.com/data/icons/junk-food-emoji-set/100/Taco_2-512.png",[Mn.VideoGame]:"https://images.emojiterra.com/google/noto-emoji/v2.034/512px/1f3ae.png"};let{setter:r}=t,{current:o}=t,{extension:a}=t,c=o.value;return e.$$set=e=>{"setter"in e&&n(2,r=e.setter),"current"in e&&n(3,o=e.current),"extension"in e&&n(4,a=e.extension)},e.$$.update=()=>{1&e.$$.dirty&&n(5,i=Cn[c].name),37&e.$$.dirty&&r({value:c,text:i})},[c,s,r,o,a,i,e=>n(0,c=parseInt(e))]}return e.ColorArgument=class extends P{constructor(e){super(),z(this,e,Pn,zn,a,{setter:1,current:2,extension:3},Rn)}},e.EmojiArgument=class extends P{constructor(e){super(),z(this,e,Un,Jn,a,{setter:2,current:3,extension:4},Dn)}},e.Extension=On,e.IconArgument=class extends P{constructor(e){super(),z(this,e,Vn,Hn,a,{setter:2,current:3,extension:4},Gn)}},Object.defineProperty(e,"__esModule",{value:!0}),e}({},ExtensionFramework);//# sourceMappingURL=scratch3prg95grpjibo.js.map
